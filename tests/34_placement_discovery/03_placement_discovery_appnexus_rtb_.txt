*** Settings ***
Resource             placement_discovery_imports.txt
Force Tags           PLACEMENT_DISCOVERY		APPNEXUS		BATCH3									
#Suite Setup			Open Browser        ${DEFAULT_BROWSER_HOME}		${BROWSER}
#Suite Teardown		Run Keywords		Close All Browsers

*** variables ***
${app_ag_banner}			59354322
${mw_ag_banner}				59354322
${online_ag_banner}			59354322
${seller_member_id}			123
*** Test Cases ***

Appnexus - Placement Discovery via Bundle ID
	[Documentation]		QA_REGRESSION_TESTS>34_Placement_Discovery (appnexus does not use bundle id)
	Set Test Variable	${app_bundle}			App Bundle ID
	Set Test Variable	${app_domain}			Nothing.com
	Set Test Variable	${app_cat}				Nothing
	Set Test Variable	${app_id}				Nothing
	Set Test Variable	${app_publisher_id}		1000000
	Set Test Variable	${app_storeurl}			Nothing
	${random_auction_id_64}=         Generate Random String 		15		123456789
	${random_device_id}=			Generate Clear Device ID 
	#Set Test Variable    ${data}   		  {"id":"${random_auction_id_64}","at":2,"tmax":120,"imp":[{"id":"1","banner":{"w":320,"h":50,"pos":1,"battr":[13]}}],"badv":["company1.com","company2.com"],"app":{"id":"${app_id}","bundle":"${app_bundle}","domain":"${app_domain}","cat":["${app_cat}"],"publisher":{"id":"${app_publisher_id}"}},"device":{"ifa":"${random_device_id}","ip":"64.124.253.1","ua":"Mozilla/5.0(Macintosh;U;IntelMacOSX10.6;en-US;rv:1.9.2.16)Gecko/20110319Firefox/3.6.16","os":"OSX"},"ext":{"appnexus":{"seller_member_id":${seller_member_id},"spend_protection":true}},"user":{"id":"45asdf987656789adfad4678rew656789"}}
	Set Test Variable 		${data}				{"id": "8765482113786061111","imp": [{"id": "${random_auction_id_64}","banner": {"w": 320,"h": 50,"id": "1","battr": [1, 2, 15],"pos": 0,"format": [{"w": 320,"h": 50}]},"instl": 0,"tagid": "12347654","secure": 1,"ext": {"appnexus": {"estimated_clear_price": 0.57,"predicted_view_rate": 0.073255,"member_ad_profile_id": 1111055,"predicted_video_completion_rate": 0.592172,"predicted_view_rate_over_total": 0.067229,"allowed_payment_types": [{"payment_type": 1,"imp_count_method": 2}]}}}],"app": {"id": "${app_id}","domain": "${app_domain}","cat": ["${app_cat}"],"bundle":"${app_bundle}","storeurl":"${app_storeurl}","page": "https://example.com/somepage.html","publisher": {"id": "${app_publisher_id}"}},"device": {"ua": "Mozilla/5.0 (Linux; Android 6.0.1; HUAWEI Build/MMB28B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Safari/537.36","geo": {"lat": 36.6203,"lon": -4.4998,"country": "US","region": "MA","metro": "1","city": "UnaCuidad","zip": "94110","utcoffset": 60,"ext": {"appnexus": {"timezone": "Africa/Ceuta"}}},"dnt": 0,"ip": "11.222.111.0","devicetype": 3,"ifa": "8d8ebc7c-77de-49d0-9519-51563b3909d2","make": "Unknown","model": "Generic Android Mobile","os": "Android","language": "es","connectiontype": 0},"user": {"id": "7939999668795769876","buyeruid": "CABBBBrbuQ9AA5DMJJJJlOL9ZOo","gender": "O","data": [{"id": "0","segment": [{"id": "1","value": "0"}]}, {"id": "1234","segment": [{"id": "4444555","value": "0"}]}]},"test": 0,"at": 1,"tmax": 150,"wseat": ["1234"],"cur": ["USD"],"bcat": ["IAB23-7", "IAB23-5", "IAB23-10", "IAB23-9", "IAB23-1", "IAB7-44", "IAB9-9", "IAB8-18", "IAB8-5"],"badv": ["url1.com", "url2.com"],"ext": {"appnexus": {"seller_member_id": 123,"spend_protection": true,"publisher_integration": {"is_header": 0,"bid_shading_high": 1,"bid_shading_medium": 0.35,"bid_shading_low": 0.95}}},"source": {"fd": 1,"tid": "2dd111ff-7777-4abc-8558-86a123ab46d6"}}				
	RTB Appnexus Request             ${RTB_APPNEXUS_API}         ${data}   
    RTB Basic Validation Appnexus			auction_id=${random_auction_id_64}			creative_id=${app_ag_banner}		
	[Tags]		

#appnexus does not have app domain, site domain is available	
Appnexus - Placement Discovery via App Domain
	[Documentation]		QA_REGRESSION_TESTS>34_Placement_Discovery (domain is AppDomain.com)
	Set Test Variable	${app_bundle}			Nothing
	Set Test Variable	${app_domain}			AppDomain.com
	Set Test Variable	${app_cat}				Nothing
	Set Test Variable	${app_id}				Nothing
	Set Test Variable	${app_publisher_id}		1000000
	Set Test Variable	${app_storeurl}			Nothing
	${random_auction_id_64}=         Generate Random String 		15		123456789
	${random_device_id}=			Generate Clear Device ID 
	#Set Test Variable    ${data}   		  {"id":"${random_auction_id_64}","at":2,"tmax":120,"imp":[{"id":"1","banner":{"w":320,"h":50,"pos":1,"battr":[13]}}],"badv":["company1.com","company2.com"],"app":{"id":"${app_id}","bundle":"${app_bundle}","domain":"${app_domain}","cat":["${app_cat}"],"publisher":{"id":"${app_publisher_id}"}},"device":{"ifa":"${random_device_id}","ip":"64.124.253.1","ua":"Mozilla/5.0(Macintosh;U;IntelMacOSX10.6;en-US;rv:1.9.2.16)Gecko/20110319Firefox/3.6.16","os":"OSX"},"ext":{"appnexus":{"seller_member_id":${seller_member_id},"spend_protection":true}},"user":{"id":"45asdf987656789adfad4678rew656789"}}
	Set Test Variable 		${data}				{"id": "8765482113786061111","imp": [{"id": "${random_auction_id_64}","banner": {"w": 320,"h": 50,"id": "1","battr": [1, 2, 15],"pos": 0,"format": [{"w": 320,"h": 50}]},"instl": 0,"tagid": "12347654","secure": 1,"ext": {"appnexus": {"estimated_clear_price": 0.57,"predicted_view_rate": 0.073255,"member_ad_profile_id": 1111055,"predicted_video_completion_rate": 0.592172,"predicted_view_rate_over_total": 0.067229,"allowed_payment_types": [{"payment_type": 1,"imp_count_method": 2}]}}}],"app": {"id": "${app_id}","domain": "${app_domain}","cat": ["${app_cat}"],"bundle":"${app_bundle}","storeurl":"${app_storeurl}","page": "https://example.com/somepage.html","publisher": {"id": "${app_publisher_id}"}},"device": {"ua": "Mozilla/5.0 (Linux; Android 6.0.1; HUAWEI Build/MMB28B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Safari/537.36","geo": {"lat": 36.6203,"lon": -4.4998,"country": "US","region": "MA","metro": "1","city": "UnaCuidad","zip": "94110","utcoffset": 60,"ext": {"appnexus": {"timezone": "Africa/Ceuta"}}},"dnt": 0,"ip": "11.222.111.0","devicetype": 3,"ifa": "8d8ebc7c-77de-49d0-9519-51563b3909d2","make": "Unknown","model": "Generic Android Mobile","os": "Android","language": "es","connectiontype": 0},"user": {"id": "7939999668795769876","buyeruid": "CABBBBrbuQ9AA5DMJJJJlOL9ZOo","gender": "O","data": [{"id": "0","segment": [{"id": "1","value": "0"}]}, {"id": "1234","segment": [{"id": "4444555","value": "0"}]}]},"test": 0,"at": 1,"tmax": 150,"wseat": ["1234"],"cur": ["USD"],"bcat": ["IAB23-7", "IAB23-5", "IAB23-10", "IAB23-9", "IAB23-1", "IAB7-44", "IAB9-9", "IAB8-18", "IAB8-5"],"badv": ["url1.com", "url2.com"],"ext": {"appnexus": {"seller_member_id": 123,"spend_protection": true,"publisher_integration": {"is_header": 0,"bid_shading_high": 1,"bid_shading_medium": 0.35,"bid_shading_low": 0.95}}},"source": {"fd": 1,"tid": "2dd111ff-7777-4abc-8558-86a123ab46d6"}}				
	
	RTB Appnexus Request             ${RTB_APPNEXUS_API}         ${data}   
    RTB Basic Validation Appnexus			auction_id=${random_auction_id_64}			creative_id=${app_ag_banner}		
    #Set Test Variable      ${ad_request_url}		${AD_PICKUP_URL}/${appnexus_auction_id}?price=0.81
    #Validate Ad Serving  ad_url=${ad_request_url}    	image_name=banner_67689_image_4INFO_320x50.gif   location=${DEFAULT_BROWSER_HOME}
    #Capture Page Screenshot With Timestamp

	[Tags]		
Appnexus - Placement Discovery via IAB Category
	[Documentation]		QA_REGRESSION_TESTS>34_Placement_Discovery (Appnexus does not have IAB category)
	Set Test Variable	${app_bundle}			Nothing
	Set Test Variable	${app_domain}			Nothing.com
	Set Test Variable	${app_cat}				Nothing
	Set Test Variable	${app_id}				Nothing
	Set Test Variable	${app_publisher_id}		1000000
	Set Test Variable	${app_storeurl}			Nothing
	${random_auction_id_64}=         Generate Random String 		15		123456789
	${random_device_id}=			Generate Clear Device ID 
	#Set Test Variable    ${data}   		  {"id":"${random_auction_id_64}","at":2,"tmax":120,"imp":[{"id":"1","banner":{"w":320,"h":50,"pos":1,"battr":[13]}}],"badv":["company1.com","company2.com"],"app":{"id":"${app_id}","bundle":"${app_bundle}","domain":"${app_domain}","cat":["${app_cat}"],"publisher":{"id":"${app_publisher_id}"}},"device":{"ifa":"${random_device_id}","ip":"64.124.253.1","ua":"Mozilla/5.0(Macintosh;U;IntelMacOSX10.6;en-US;rv:1.9.2.16)Gecko/20110319Firefox/3.6.16","os":"OSX"},"ext":{"appnexus":{"seller_member_id":${seller_member_id},"spend_protection":true}},"user":{"id":"45asdf987656789adfad4678rew656789"}}
	Set Test Variable 		${data}				{"id": "8765482113786061111","imp": [{"id": "${random_auction_id_64}","banner": {"w": 320,"h": 50,"id": "1","battr": [1, 2, 15],"pos": 0,"format": [{"w": 320,"h": 50}]},"instl": 0,"tagid": "12347654","secure": 1,"ext": {"appnexus": {"estimated_clear_price": 0.57,"predicted_view_rate": 0.073255,"member_ad_profile_id": 1111055,"predicted_video_completion_rate": 0.592172,"predicted_view_rate_over_total": 0.067229,"allowed_payment_types": [{"payment_type": 1,"imp_count_method": 2}]}}}],"app": {"id": "${app_id}","domain": "${app_domain}","cat": ["${app_cat}"],"bundle":"${app_bundle}","storeurl":"${app_storeurl}","page": "https://example.com/somepage.html","publisher": {"id": "${app_publisher_id}"}},"device": {"ua": "Mozilla/5.0 (Linux; Android 6.0.1; HUAWEI Build/MMB28B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Safari/537.36","geo": {"lat": 36.6203,"lon": -4.4998,"country": "US","region": "MA","metro": "1","city": "UnaCuidad","zip": "94110","utcoffset": 60,"ext": {"appnexus": {"timezone": "Africa/Ceuta"}}},"dnt": 0,"ip": "11.222.111.0","devicetype": 3,"ifa": "8d8ebc7c-77de-49d0-9519-51563b3909d2","make": "Unknown","model": "Generic Android Mobile","os": "Android","language": "es","connectiontype": 0},"user": {"id": "7939999668795769876","buyeruid": "CABBBBrbuQ9AA5DMJJJJlOL9ZOo","gender": "O","data": [{"id": "0","segment": [{"id": "1","value": "0"}]}, {"id": "1234","segment": [{"id": "4444555","value": "0"}]}]},"test": 0,"at": 1,"tmax": 150,"wseat": ["1234"],"cur": ["USD"],"bcat": ["IAB23-7", "IAB23-5", "IAB23-10", "IAB23-9", "IAB23-1", "IAB7-44", "IAB9-9", "IAB8-18", "IAB8-5"],"badv": ["url1.com", "url2.com"],"ext": {"appnexus": {"seller_member_id": 123,"spend_protection": true,"publisher_integration": {"is_header": 0,"bid_shading_high": 1,"bid_shading_medium": 0.35,"bid_shading_low": 0.95}}},"source": {"fd": 1,"tid": "2dd111ff-7777-4abc-8558-86a123ab46d6"}}				
	
	RTB Appnexus Request             ${RTB_APPNEXUS_API}         ${data}   
    RTB Basic Validation Appnexus			auction_id=${random_auction_id_64}			creative_id=${app_ag_banner}		
	[Tags]	Exclude
	
Appnexus - Placement Discovery via App ID
	[Documentation]		QA_REGRESSION_TESTS>34_Placement_Discovery 
	Set Test Variable	${app_bundle}			Nothing
	Set Test Variable	${app_domain}			Nothing.com
	Set Test Variable	${app_cat}				Nothing
	Set Test Variable	${app_id}				App ID
	Set Test Variable	${app_publisher_id}		1000000
	Set Test Variable	${app_storeurl}			Nothing
	${random_auction_id_64}=         Generate Random String 		15		123456789
	${random_device_id}=			Generate Clear Device ID 
	#Set Test Variable    ${data}   		  {"id":"${random_auction_id_64}","at":2,"tmax":120,"imp":[{"id":"1","banner":{"w":320,"h":50,"pos":1,"battr":[13]}}],"badv":["company1.com","company2.com"],"app":{"id":"${app_id}","bundle":"${app_bundle}","domain":"${app_domain}","cat":["${app_cat}"],"publisher":{"id":"${app_publisher_id}"}},"device":{"ifa":"${random_device_id}","ip":"64.124.253.1","ua":"Mozilla/5.0(Macintosh;U;IntelMacOSX10.6;en-US;rv:1.9.2.16)Gecko/20110319Firefox/3.6.16","os":"OSX"},"ext":{"appnexus":{"seller_member_id":${seller_member_id},"spend_protection":true}},"user":{"id":"45asdf987656789adfad4678rew656789"}}
	Set Test Variable 		${data}				{"id": "8765482113786061111","imp": [{"id": "${random_auction_id_64}","banner": {"w": 320,"h": 50,"id": "1","battr": [1, 2, 15],"pos": 0,"format": [{"w": 320,"h": 50}]},"instl": 0,"tagid": "12347654","secure": 1,"ext": {"appnexus": {"estimated_clear_price": 0.57,"predicted_view_rate": 0.073255,"member_ad_profile_id": 1111055,"predicted_video_completion_rate": 0.592172,"predicted_view_rate_over_total": 0.067229,"allowed_payment_types": [{"payment_type": 1,"imp_count_method": 2}]}}}],"app": {"id": "${app_id}","domain": "${app_domain}","cat": ["${app_cat}"],"bundle":"${app_bundle}","storeurl":"${app_storeurl}","page": "https://example.com/somepage.html","publisher": {"id": "${app_publisher_id}"}},"device": {"ua": "Mozilla/5.0 (Linux; Android 6.0.1; HUAWEI Build/MMB28B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Safari/537.36","geo": {"lat": 36.6203,"lon": -4.4998,"country": "US","region": "MA","metro": "1","city": "UnaCuidad","zip": "94110","utcoffset": 60,"ext": {"appnexus": {"timezone": "Africa/Ceuta"}}},"dnt": 0,"ip": "11.222.111.0","devicetype": 3,"ifa": "8d8ebc7c-77de-49d0-9519-51563b3909d2","make": "Unknown","model": "Generic Android Mobile","os": "Android","language": "es","connectiontype": 0},"user": {"id": "7939999668795769876","buyeruid": "CABBBBrbuQ9AA5DMJJJJlOL9ZOo","gender": "O","data": [{"id": "0","segment": [{"id": "1","value": "0"}]}, {"id": "1234","segment": [{"id": "4444555","value": "0"}]}]},"test": 0,"at": 1,"tmax": 150,"wseat": ["1234"],"cur": ["USD"],"bcat": ["IAB23-7", "IAB23-5", "IAB23-10", "IAB23-9", "IAB23-1", "IAB7-44", "IAB9-9", "IAB8-18", "IAB8-5"],"badv": ["url1.com", "url2.com"],"ext": {"appnexus": {"seller_member_id": 123,"spend_protection": true,"publisher_integration": {"is_header": 0,"bid_shading_high": 1,"bid_shading_medium": 0.35,"bid_shading_low": 0.95}}},"source": {"fd": 1,"tid": "2dd111ff-7777-4abc-8558-86a123ab46d6"}}				
	
	RTB Appnexus Request             ${RTB_APPNEXUS_API}         ${data}   
    RTB Basic Validation Appnexus			auction_id=${random_auction_id_64}			creative_id=${app_ag_banner}		
 	[Tags]	
	
Appnexus - Placement Discovery via Publisher ID
	[Documentation]		QA_REGRESSION_TESTS>34_Placement_Discovery (Publisher ID is 333333)
	Set Test Variable	${app_bundle}			Nothing
	Set Test Variable	${app_domain}			Nothing.com
	Set Test Variable	${app_cat}				Nothing
	Set Test Variable	${app_id}				Nothing
	Set Test Variable	${app_publisher_id}		333333
	Set Test Variable	${app_storeurl}			Nothing
	${random_auction_id_64}=         Generate Random String 		15		123456789
	${random_device_id}=			Generate Clear Device ID 
	#Set Test Variable    ${data}   		  {"id":"${random_auction_id_64}","at":2,"tmax":120,"imp":[{"id":"1","banner":{"w":320,"h":50,"pos":1,"battr":[13]}}],"badv":["company1.com","company2.com"],"app":{"id":"${app_id}","bundle":"${app_bundle}","domain":"${app_domain}","cat":["${app_cat}"],"publisher":{"id":"${app_publisher_id}"}},"device":{"ifa":"${random_device_id}","ip":"64.124.253.1","ua":"Mozilla/5.0(Macintosh;U;IntelMacOSX10.6;en-US;rv:1.9.2.16)Gecko/20110319Firefox/3.6.16","os":"OSX"},"ext":{"appnexus":{"seller_member_id":${seller_member_id},"spend_protection":true}},"user":{"id":"45asdf987656789adfad4678rew656789"}}
	Set Test Variable 		${data}				{"id": "8765482113786061111","imp": [{"id": "${random_auction_id_64}","banner": {"w": 320,"h": 50,"id": "1","battr": [1, 2, 15],"pos": 0,"format": [{"w": 320,"h": 50}]},"instl": 0,"tagid": "12347654","secure": 1,"ext": {"appnexus": {"estimated_clear_price": 0.57,"predicted_view_rate": 0.073255,"member_ad_profile_id": 1111055,"predicted_video_completion_rate": 0.592172,"predicted_view_rate_over_total": 0.067229,"allowed_payment_types": [{"payment_type": 1,"imp_count_method": 2}]}}}],"app": {"id": "${app_id}","domain": "${app_domain}","cat": ["${app_cat}"],"bundle":"${app_bundle}","storeurl":"${app_storeurl}","page": "https://example.com/somepage.html","publisher": {"id": "${app_publisher_id}"}},"device": {"ua": "Mozilla/5.0 (Linux; Android 6.0.1; HUAWEI Build/MMB28B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Safari/537.36","geo": {"lat": 36.6203,"lon": -4.4998,"country": "US","region": "MA","metro": "1","city": "UnaCuidad","zip": "94110","utcoffset": 60,"ext": {"appnexus": {"timezone": "Africa/Ceuta"}}},"dnt": 0,"ip": "11.222.111.0","devicetype": 3,"ifa": "8d8ebc7c-77de-49d0-9519-51563b3909d2","make": "Unknown","model": "Generic Android Mobile","os": "Android","language": "es","connectiontype": 0},"user": {"id": "7939999668795769876","buyeruid": "CABBBBrbuQ9AA5DMJJJJlOL9ZOo","gender": "O","data": [{"id": "0","segment": [{"id": "1","value": "0"}]}, {"id": "1234","segment": [{"id": "4444555","value": "0"}]}]},"test": 0,"at": 1,"tmax": 150,"wseat": ["1234"],"cur": ["USD"],"bcat": ["IAB23-7", "IAB23-5", "IAB23-10", "IAB23-9", "IAB23-1", "IAB7-44", "IAB9-9", "IAB8-18", "IAB8-5"],"badv": ["url1.com", "url2.com"],"ext": {"appnexus": {"seller_member_id": 123,"spend_protection": true,"publisher_integration": {"is_header": 0,"bid_shading_high": 1,"bid_shading_medium": 0.35,"bid_shading_low": 0.95}}},"source": {"fd": 1,"tid": "2dd111ff-7777-4abc-8558-86a123ab46d6"}}				
	
	RTB Appnexus Request             ${RTB_APPNEXUS_API}         ${data}   
    RTB Basic Validation Appnexus			auction_id=${random_auction_id_64}			creative_id=${app_ag_banner}		
 	[Tags]

#Appnexus does not have store url	
Appnexus - Placement Discovery via App Store URL
	[Documentation]		QA_REGRESSION_TESTS>34_Placement_Discovery (app storeurl does not exist for appnexus)
	Set Test Variable	${app_bundle}			Nothing
	Set Test Variable	${app_domain}			Nothing.com
	Set Test Variable	${app_cat}				Nothing
	Set Test Variable	${app_id}				Nothing
	Set Test Variable	${app_publisher_id}		1000000
	Set Test Variable	${app_storeurl}			App Store URL
	${random_auction_id_64}=         Generate Random String 		15		123456789
	${random_device_id}=			Generate Clear Device ID 
	#Set Test Variable    ${data}   		  {"id":"${random_auction_id_64}","at":2,"tmax":120,"imp":[{"id":"1","banner":{"w":320,"h":50,"pos":1,"battr":[13]}}],"badv":["company1.com","company2.com"],"app":{"id":"${app_id}","bundle":"${app_bundle}","domain":"${app_domain}","cat":["${app_cat}"],"publisher":{"id":"${app_publisher_id}"}},"device":{"ifa":"${random_device_id}","ip":"64.124.253.1","ua":"Mozilla/5.0(Macintosh;U;IntelMacOSX10.6;en-US;rv:1.9.2.16)Gecko/20110319Firefox/3.6.16","os":"OSX"},"ext":{"appnexus":{"seller_member_id":${seller_member_id},"spend_protection":true}},"user":{"id":"45asdf987656789adfad4678rew656789"}}
	Set Test Variable 		${data}				{"id": "8765482113786061111","imp": [{"id": "${random_auction_id_64}","banner": {"w": 320,"h": 50,"id": "1","battr": [1, 2, 15],"pos": 0,"format": [{"w": 320,"h": 50}]},"instl": 0,"tagid": "12347654","secure": 1,"ext": {"appnexus": {"estimated_clear_price": 0.57,"predicted_view_rate": 0.073255,"member_ad_profile_id": 1111055,"predicted_video_completion_rate": 0.592172,"predicted_view_rate_over_total": 0.067229,"allowed_payment_types": [{"payment_type": 1,"imp_count_method": 2}]}}}],"app": {"id": "${app_id}","domain": "${app_domain}","cat": ["${app_cat}"],"bundle":"${app_bundle}","storeurl":"${app_storeurl}","page": "https://example.com/somepage.html","publisher": {"id": "${app_publisher_id}"}},"device": {"ua": "Mozilla/5.0 (Linux; Android 6.0.1; HUAWEI Build/MMB28B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Safari/537.36","geo": {"lat": 36.6203,"lon": -4.4998,"country": "US","region": "MA","metro": "1","city": "UnaCuidad","zip": "94110","utcoffset": 60,"ext": {"appnexus": {"timezone": "Africa/Ceuta"}}},"dnt": 0,"ip": "11.222.111.0","devicetype": 3,"ifa": "8d8ebc7c-77de-49d0-9519-51563b3909d2","make": "Unknown","model": "Generic Android Mobile","os": "Android","language": "es","connectiontype": 0},"user": {"id": "7939999668795769876","buyeruid": "CABBBBrbuQ9AA5DMJJJJlOL9ZOo","gender": "O","data": [{"id": "0","segment": [{"id": "1","value": "0"}]}, {"id": "1234","segment": [{"id": "4444555","value": "0"}]}]},"test": 0,"at": 1,"tmax": 150,"wseat": ["1234"],"cur": ["USD"],"bcat": ["IAB23-7", "IAB23-5", "IAB23-10", "IAB23-9", "IAB23-1", "IAB7-44", "IAB9-9", "IAB8-18", "IAB8-5"],"badv": ["url1.com", "url2.com"],"ext": {"appnexus": {"seller_member_id": 123,"spend_protection": true,"publisher_integration": {"is_header": 0,"bid_shading_high": 1,"bid_shading_medium": 0.35,"bid_shading_low": 0.95}}},"source": {"fd": 1,"tid": "2dd111ff-7777-4abc-8558-86a123ab46d6"}}				
	
	RTB Appnexus Request             ${RTB_APPNEXUS_API}         ${data}   
    RTB Basic Validation Appnexus			auction_id=${random_auction_id_64}			creative_id=${app_ag_banner}		
 	[Tags]		Exclude

Appnexus - Placement Discovery via Publisher ID only in Site,Online (not serve)
	[Documentation]		QA_REGRESSION_TESTS>34_Placement_Discovery (publisher id must be a number - 2233445566778899)
	Set Test Variable	${app_bundle}			Nothing
	Set Test Variable	${app_domain}			Nothing.com
	Set Test Variable	${app_cat}				Nothing
	Set Test Variable	${app_id}				Nothing
	Set Test Variable	${app_publisher_id}		2233445566778899
	Set Test Variable	${app_storeurl}			Nothing
	${random_auction_id_64}=         Generate Random String 		15		123456789
	${random_device_id}=			Generate Clear Device ID 
	#Set Test Variable    ${data}   		  {"id":"${random_auction_id_64}","at":2,"tmax":120,"imp":[{"id":"1","banner":{"w":320,"h":50,"pos":1,"battr":[13]}}],"badv":["company1.com","company2.com"],"app":{"id":"${app_id}","bundle":"${app_bundle}","domain":"${app_domain}","cat":["${app_cat}"],"publisher":{"id":"${app_publisher_id}"}},"device":{"ifa":"${random_device_id}","ip":"64.124.253.1","ua":"Mozilla/5.0(Macintosh;U;IntelMacOSX10.6;en-US;rv:1.9.2.16)Gecko/20110319Firefox/3.6.16","os":"OSX"},"ext":{"appnexus":{"seller_member_id":${seller_member_id},"spend_protection":true}},"user":{"id":"45asdf987656789adfad4678rew656789"}}
	Set Test Variable 		${data}				{"id": "8765482113786061111","imp": [{"id": "${random_auction_id_64}","banner": {"w": 320,"h": 50,"id": "1","battr": [1, 2, 15],"pos": 0,"format": [{"w": 320,"h": 50}]},"instl": 0,"tagid": "12347654","secure": 1,"ext": {"appnexus": {"estimated_clear_price": 0.57,"predicted_view_rate": 0.073255,"member_ad_profile_id": 1111055,"predicted_video_completion_rate": 0.592172,"predicted_view_rate_over_total": 0.067229,"allowed_payment_types": [{"payment_type": 1,"imp_count_method": 2}]}}}],"app": {"id": "${app_id}","domain": "${app_domain}","cat": ["${app_cat}"],"bundle":"${app_bundle}","storeurl":"${app_storeurl}","page": "https://example.com/somepage.html","publisher": {"id": "${app_publisher_id}"}},"device": {"ua": "Mozilla/5.0 (Linux; Android 6.0.1; HUAWEI Build/MMB28B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Safari/537.36","geo": {"lat": 36.6203,"lon": -4.4998,"country": "US","region": "MA","metro": "1","city": "UnaCuidad","zip": "94110","utcoffset": 60,"ext": {"appnexus": {"timezone": "Africa/Ceuta"}}},"dnt": 0,"ip": "11.222.111.0","devicetype": 3,"ifa": "8d8ebc7c-77de-49d0-9519-51563b3909d2","make": "Unknown","model": "Generic Android Mobile","os": "Android","language": "es","connectiontype": 0},"user": {"id": "7939999668795769876","buyeruid": "CABBBBrbuQ9AA5DMJJJJlOL9ZOo","gender": "O","data": [{"id": "0","segment": [{"id": "1","value": "0"}]}, {"id": "1234","segment": [{"id": "4444555","value": "0"}]}]},"test": 0,"at": 1,"tmax": 150,"wseat": ["1234"],"cur": ["USD"],"bcat": ["IAB23-7", "IAB23-5", "IAB23-10", "IAB23-9", "IAB23-1", "IAB7-44", "IAB9-9", "IAB8-18", "IAB8-5"],"badv": ["url1.com", "url2.com"],"ext": {"appnexus": {"seller_member_id": 123,"spend_protection": true,"publisher_integration": {"is_header": 0,"bid_shading_high": 1,"bid_shading_medium": 0.35,"bid_shading_low": 0.95}}},"source": {"fd": 1,"tid": "2dd111ff-7777-4abc-8558-86a123ab46d6"}}				
	
	RTB Appnexus Request             ${RTB_APPNEXUS_API}         ${data}   		response_code=204
    #RTB Basic Validation Appnexus			auction_id=${random_auction_id_64}			creative_id=${app_ag_banner}	
 	[Tags]		Exclude		

Appnexus - Placement Discovery via Publisher Not MW (Same Publisher as Online)
	[Documentation]		QA_REGRESSION_TESTS>34_Placement_Discovery (Publisher ID must be a number 22334455667788)
	Set Test Variable	${app_bundle}			Nothing
	Set Test Variable	${app_domain}			Nothing.com
	Set Test Variable	${app_cat}				Nothing
	Set Test Variable	${app_id}				Nothing
	Set Test Variable	${app_publisher_id}		22334455667788
	Set Test Variable	${app_storeurl}			Nothing
	${random_auction_id_64}=         Generate Random String 		15		123456789
	${random_device_id}=			Generate Clear Device ID 
	#Set Test Variable    ${data}   		  {"id":"${random_auction_id_64}","at":2,"tmax":120,"imp":[{"id":"1","banner":{"w":320,"h":50,"pos":1,"battr":[13]}}],"badv":["company1.com","company2.com"],"app":{"id":"${app_id}","bundle":"${app_bundle}","domain":"${app_domain}","cat":["${app_cat}"],"publisher":{"id":"${app_publisher_id}"}},"device":{"ifa":"${random_device_id}","ip":"64.124.253.1","ua":"Mozilla/5.0(Macintosh;U;IntelMacOSX10.6;en-US;rv:1.9.2.16)Gecko/20110319Firefox/3.6.16","os":"OSX"},"ext":{"appnexus":{"seller_member_id":${seller_member_id},"spend_protection":true}},"user":{"id":"45asdf987656789adfad4678rew656789"}}
	Set Test Variable 		${data}				{"id": "8765482113786061111","imp": [{"id": "${random_auction_id_64}","banner": {"w": 320,"h": 50,"id": "1","battr": [1, 2, 15],"pos": 0,"format": [{"w": 320,"h": 50}]},"instl": 0,"tagid": "12347654","secure": 1,"ext": {"appnexus": {"estimated_clear_price": 0.57,"predicted_view_rate": 0.073255,"member_ad_profile_id": 1111055,"predicted_video_completion_rate": 0.592172,"predicted_view_rate_over_total": 0.067229,"allowed_payment_types": [{"payment_type": 1,"imp_count_method": 2}]}}}],"app": {"id": "${app_id}","domain": "${app_domain}","cat": ["${app_cat}"],"bundle":"${app_bundle}","storeurl":"${app_storeurl}","page": "https://example.com/somepage.html","publisher": {"id": "${app_publisher_id}"}},"device": {"ua": "Mozilla/5.0 (Linux; Android 6.0.1; HUAWEI Build/MMB28B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Safari/537.36","geo": {"lat": 36.6203,"lon": -4.4998,"country": "US","region": "MA","metro": "1","city": "UnaCuidad","zip": "94110","utcoffset": 60,"ext": {"appnexus": {"timezone": "Africa/Ceuta"}}},"dnt": 0,"ip": "11.222.111.0","devicetype": 3,"ifa": "8d8ebc7c-77de-49d0-9519-51563b3909d2","make": "Unknown","model": "Generic Android Mobile","os": "Android","language": "es","connectiontype": 0},"user": {"id": "7939999668795769876","buyeruid": "CABBBBrbuQ9AA5DMJJJJlOL9ZOo","gender": "O","data": [{"id": "0","segment": [{"id": "1","value": "0"}]}, {"id": "1234","segment": [{"id": "4444555","value": "0"}]}]},"test": 0,"at": 1,"tmax": 150,"wseat": ["1234"],"cur": ["USD"],"bcat": ["IAB23-7", "IAB23-5", "IAB23-10", "IAB23-9", "IAB23-1", "IAB7-44", "IAB9-9", "IAB8-18", "IAB8-5"],"badv": ["url1.com", "url2.com"],"ext": {"appnexus": {"seller_member_id": 123,"spend_protection": true,"publisher_integration": {"is_header": 0,"bid_shading_high": 1,"bid_shading_medium": 0.35,"bid_shading_low": 0.95}}},"source": {"fd": 1,"tid": "2dd111ff-7777-4abc-8558-86a123ab46d6"}}				
	
	RTB Appnexus Request             ${RTB_APPNEXUS_API}         ${data}   		response_code=204
    [Tags]			

Appnexus - Placement Discovery via Publisher Not Online (Same Publisher as MW)
	[Documentation]		QA_REGRESSION_TESTS>34_Placement_Discovery (Publisher ID must be a number 112233445566)
	Set Test Variable	${app_bundle}			Nothing
	Set Test Variable	${app_domain}			Nothing.com
	Set Test Variable	${app_cat}				Nothing
	Set Test Variable	${app_id}				Nothing
	Set Test Variable	${app_publisher_id}		223344556677889900
	Set Test Variable	${app_storeurl}			Nothing
	${random_auction_id_64}=         Generate Random String 		15		123456789
	${random_device_id}=			Generate Clear Device ID 
	#Set Test Variable    ${data}   		  {"id":"${random_auction_id_64}","at":2,"tmax":120,"imp":[{"id":"1","banner":{"w":320,"h":50,"pos":1,"battr":[13]}}],"badv":["company1.com","company2.com"],"app":{"id":"${app_id}","bundle":"${app_bundle}","domain":"${app_domain}","cat":["${app_cat}"],"publisher":{"id":"${app_publisher_id}"}},"device":{"ifa":"${random_device_id}","ip":"64.124.253.1","ua":"Mozilla/5.0(Macintosh;U;IntelMacOSX10.6;en-US;rv:1.9.2.16)Gecko/20110319Firefox/3.6.16","os":"OSX"},"ext":{"appnexus":{"seller_member_id":${seller_member_id},"spend_protection":true}},"user":{"id":"45asdf987656789adfad4678rew656789"}}
	Set Test Variable 		${data}				{"id": "8765482113786061111","imp": [{"id": "${random_auction_id_64}","banner": {"w": 320,"h": 50,"id": "1","battr": [1, 2, 15],"pos": 0,"format": [{"w": 320,"h": 50}]},"instl": 0,"tagid": "12347654","secure": 1,"ext": {"appnexus": {"estimated_clear_price": 0.57,"predicted_view_rate": 0.073255,"member_ad_profile_id": 1111055,"predicted_video_completion_rate": 0.592172,"predicted_view_rate_over_total": 0.067229,"allowed_payment_types": [{"payment_type": 1,"imp_count_method": 2}]}}}],"app": {"id": "${app_id}","domain": "${app_domain}","cat": ["${app_cat}"],"bundle":"${app_bundle}","storeurl":"${app_storeurl}","page": "https://example.com/somepage.html","publisher": {"id": "${app_publisher_id}"}},"device": {"ua": "Mozilla/5.0 (Linux; Android 6.0.1; HUAWEI Build/MMB28B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Safari/537.36","geo": {"lat": 36.6203,"lon": -4.4998,"country": "US","region": "MA","metro": "1","city": "UnaCuidad","zip": "94110","utcoffset": 60,"ext": {"appnexus": {"timezone": "Africa/Ceuta"}}},"dnt": 0,"ip": "11.222.111.0","devicetype": 3,"ifa": "8d8ebc7c-77de-49d0-9519-51563b3909d2","make": "Unknown","model": "Generic Android Mobile","os": "Android","language": "es","connectiontype": 0},"user": {"id": "7939999668795769876","buyeruid": "CABBBBrbuQ9AA5DMJJJJlOL9ZOo","gender": "O","data": [{"id": "0","segment": [{"id": "1","value": "0"}]}, {"id": "1234","segment": [{"id": "4444555","value": "0"}]}]},"test": 0,"at": 1,"tmax": 150,"wseat": ["1234"],"cur": ["USD"],"bcat": ["IAB23-7", "IAB23-5", "IAB23-10", "IAB23-9", "IAB23-1", "IAB7-44", "IAB9-9", "IAB8-18", "IAB8-5"],"badv": ["url1.com", "url2.com"],"ext": {"appnexus": {"seller_member_id": 123,"spend_protection": true,"publisher_integration": {"is_header": 0,"bid_shading_high": 1,"bid_shading_medium": 0.35,"bid_shading_low": 0.95}}},"source": {"fd": 1,"tid": "2dd111ff-7777-4abc-8558-86a123ab46d6"}}				
	
	RTB Appnexus Request             ${RTB_APPNEXUS_API}         ${data}   
    RTB Basic Validation Appnexus			auction_id=${random_auction_id_64}			creative_id=${app_ag_banner}		
 	#RTB Appnexus Request 				API=${RTB_APPNEXUS_API}          data=${data}		response_code=no_bid        submit_client_impression_event=NO
	[Tags]			




Appnexus - Placement Discovery via Site Domain
	[Documentation]		QA_REGRESSION_TESTS>34_Placement_Discovery (SiteDomain.com, site id must be a number)
	Set Test Variable	${site_bundle}			Nothing
	Set Test Variable	${site_domain}			SiteDomain.com
	Set Test Variable	${site_cat}				Nothing
	Set Test Variable	${site_id}				100000
	Set Test Variable	${site_publisher_id}		1000000
	Set Test Variable	${site_storeurl}			Nothing
	${random_auction_id_64}=         Generate Random String 		15		123456789
	#Set Test Variable    ${data}   		  {"bid_request":{"timestamp":"2016-12-15 21:52:51","bidder_timeout_ms":100,"members":[{"id":2049}],"member_ad_profile_id":163870,"excluded_technical_attributes":[33],"tags":[{"auction_id_64":${random_auction_id_64},"smaller_sizes_allowed":false,"position":"unknown","tag_format":"iframe","ad_profile_id":928663,"visibility_profile_id":8181,"allowed_media_types":[1],"media_subtypes":["banner"],"predicted_view_rate":0.21,"size":"320x50","sizes":["320x50","320x100"],"estimated_clear_price":6.20000,"estimated_average_price":2.0800,"id":9852411,"site_id":"${site_id}","venue_id":1511282,"inventory_audits":[{"auditor_member_id":1908,"intended_audience":"general","content_categories":[32424,32429,32430,36102]}],"deals_only":false,"predicted_engagement_rates":[{"engagement_rate_type":"video_completion","rate":1.00}]}],"bid_info":{"no_cookies":true,"payment_rule_id":1101471,"no_flash":false,"certified_supply":true,"spend_protection":true,"browser":12,"operating_system":8,"operating_system_extended":160,"operating_system_family":3,"carrier":1,"device_make":26,"device_type":2,"language":1,"session_freq":1,"pub_session_freq":1,"country":"US","within_iframe":false,"selling_member_id":1908,"publisher_id":${site_publisher_id},"user_id_64":0,"ip_address":"174.59.130.115","user_agent":"Mozilla/5.0 (iPhone; CPU iPhone OS 10_1_1 like Mac OS X) AppleWebKit/602.2.14 (KHTML, like Gecko) Version/10.0 Mobile/14B100 Safari/602.1","accepted_languages":"en-us","region":"PA","city":"Elizabethville","postal_code":"17023","postal_code_id":12355,"dma":566,"time_zone":"America/Indiana/Vevay","url":"http://colleges.startclass.com/compare/3624-3683/Elizabethtown-College-vs-Lebanon-Valley-College","domain":"${site_domain}","device_model":301,"inventory_url_id":1367861,"inventory_audits":[{"auditor_member_id":null,"intended_audience":"general","content_categories":[17,8302]}],"userdata_json":"{}"}}}	
	Set Test Variable    ${data}			{"id": "8765482113786061111","imp": [{"id": "${random_auction_id_64}","banner": {"w": 320,"h": 50,"id": "1","battr": [1, 2, 15],"pos": 0,"format": [{"w": 320,"h": 50}]},"instl": 0,"tagid": "12347654","secure": 1,"ext": {"appnexus": {"estimated_clear_price": 0.57,"predicted_view_rate": 0.073255,"member_ad_profile_id": 1111055,"predicted_video_completion_rate": 0.592172,"predicted_view_rate_over_total": 0.067229,"allowed_payment_types": [{"payment_type": 1,"imp_count_method": 2}]}}}],"site": {"id": "${site_id}","domain": "${site_domain}","cat": ["${site_cat}"],"bundle":"${site_bundle}","storeurl":"${site_storeurl}","page": "https://example.com/somepage.html","publisher": {"id": "${site_publisher_id}"}},"device": {"ua": "Mozilla/5.0 (Linux; Android 6.0.1; HUAWEI Build/MMB28B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Safari/537.36","geo": {"lat": 36.6203,"lon": -4.4998,"country": "US","region": "MA","metro": "1","city": "UnaCuidad","zip": "94110","utcoffset": 60,"ext": {"appnexus": {"timezone": "Africa/Ceuta"}}},"dnt": 0,"ip": "11.222.111.0","devicetype": 3,"ifa": "8d8ebc7c-77de-49d0-9519-51563b3909d2","make": "Unknown","model": "Generic Android Mobile","os": "Android","language": "es","connectiontype": 0},"user": {"id": "7939999668795769876","buyeruid": "CABBBBrbuQ9AA5DMJJJJlOL9ZOo","gender": "O","data": [{"id": "0","segment": [{"id": "1","value": "0"}]}, {"id": "1234","segment": [{"id": "4444555","value": "0"}]}]},"test": 0,"at": 1,"tmax": 150,"wseat": ["1234"],"cur": ["USD"],"bcat": ["IAB23-7", "IAB23-5", "IAB23-10", "IAB23-9", "IAB23-1", "IAB7-44", "IAB9-9", "IAB8-18", "IAB8-5"],"badv": ["url1.com", "url2.com"],"ext": {"appnexus": {"seller_member_id": 123,"spend_protection": true,"publisher_integration": {"is_header": 0,"bid_shading_high": 1,"bid_shading_medium": 0.35,"bid_shading_low": 0.95}}},"source": {"fd": 1,"tid": "2dd111ff-7777-4abc-8558-86a123ab46d6"}}
	RTB Appnexus Request             ${RTB_APPNEXUS_API}         ${data}   
    RTB Basic Validation Appnexus			auction_id=${random_auction_id_64}			creative_id=${mw_ag_banner}		
    #Set Test Variable      ${ad_request_url}		${AD_PICKUP_URL}/${appnexus_auction_id}?price=0.81
    #Validate Ad Serving  ad_url=${ad_request_url}    	image_name=banner_67689_image_4INFO_320x50.gif   location=${DEFAULT_BROWSER_HOME}
    #Capture Page Screenshot With Timestamp
    
	[Tags] 		

Appnexus - Placement Discovery via Site IAB Category
	[Documentation]		QA_REGRESSION_TESTS>34_Placement_Discovery (Appnexus does not have IAB cat)
	Set Test Variable	${site_bundle}			Nothing
	Set Test Variable	${site_domain}			SiteDomain.com
	Set Test Variable	${site_cat}				Nothing
	Set Test Variable	${site_id}				100000
	Set Test Variable	${site_publisher_id}		1000000
	Set Test Variable	${site_storeurl}			Nothing
	${random_auction_id_64}=         Generate Random String 		15		123456789
	#Set Test Variable    ${data}   		  {"bid_request":{"timestamp":"2016-12-15 21:52:51","bidder_timeout_ms":100,"members":[{"id":2049}],"member_ad_profile_id":163870,"excluded_technical_attributes":[33],"tags":[{"auction_id_64":${random_auction_id_64},"smaller_sizes_allowed":false,"position":"unknown","tag_format":"iframe","ad_profile_id":928663,"visibility_profile_id":8181,"allowed_media_types":[1],"media_subtypes":["banner"],"predicted_view_rate":0.21,"size":"320x50","sizes":["320x50","320x100"],"estimated_clear_price":6.20000,"estimated_average_price":2.0800,"id":9852411,"site_id":"${site_id}","venue_id":1511282,"inventory_audits":[{"auditor_member_id":1908,"intended_audience":"general","content_categories":[32424,32429,32430,36102]}],"deals_only":false,"predicted_engagement_rates":[{"engagement_rate_type":"video_completion","rate":1.00}]}],"bid_info":{"no_cookies":true,"payment_rule_id":1101471,"no_flash":false,"certified_supply":true,"spend_protection":true,"browser":12,"operating_system":8,"operating_system_extended":160,"operating_system_family":3,"carrier":1,"device_make":26,"device_type":2,"language":1,"session_freq":1,"pub_session_freq":1,"country":"US","within_iframe":false,"selling_member_id":1908,"publisher_id":${site_publisher_id},"user_id_64":0,"ip_address":"174.59.130.115","user_agent":"Mozilla/5.0 (iPhone; CPU iPhone OS 10_1_1 like Mac OS X) AppleWebKit/602.2.14 (KHTML, like Gecko) Version/10.0 Mobile/14B100 Safari/602.1","accepted_languages":"en-us","region":"PA","city":"Elizabethville","postal_code":"17023","postal_code_id":12355,"dma":566,"time_zone":"America/Indiana/Vevay","url":"http://colleges.startclass.com/compare/3624-3683/Elizabethtown-College-vs-Lebanon-Valley-College","domain":"${site_domain}","device_model":301,"inventory_url_id":1367861,"inventory_audits":[{"auditor_member_id":null,"intended_audience":"general","content_categories":[17,8302]}],"userdata_json":"{}"}}}	
	Set Test Variable    ${data}			{"id": "8765482113786061111","imp": [{"id": "${random_auction_id_64}","banner": {"w": 320,"h": 50,"id": "1","battr": [1, 2, 15],"pos": 0,"format": [{"w": 320,"h": 50}]},"instl": 0,"tagid": "12347654","secure": 1,"ext": {"appnexus": {"estimated_clear_price": 0.57,"predicted_view_rate": 0.073255,"member_ad_profile_id": 1111055,"predicted_video_completion_rate": 0.592172,"predicted_view_rate_over_total": 0.067229,"allowed_payment_types": [{"payment_type": 1,"imp_count_method": 2}]}}}],"site": {"id": "${site_id}","domain": "${site_domain}","cat": ["${site_cat}"],"bundle":"${site_bundle}","storeurl":"${site_storeurl}","page": "https://example.com/somepage.html","publisher": {"id": "${site_publisher_id}"}},"device": {"ua": "Mozilla/5.0 (Linux; Android 6.0.1; HUAWEI Build/MMB28B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Safari/537.36","geo": {"lat": 36.6203,"lon": -4.4998,"country": "US","region": "MA","metro": "1","city": "UnaCuidad","zip": "94110","utcoffset": 60,"ext": {"appnexus": {"timezone": "Africa/Ceuta"}}},"dnt": 0,"ip": "11.222.111.0","devicetype": 3,"ifa": "8d8ebc7c-77de-49d0-9519-51563b3909d2","make": "Unknown","model": "Generic Android Mobile","os": "Android","language": "es","connectiontype": 0},"user": {"id": "7939999668795769876","buyeruid": "CABBBBrbuQ9AA5DMJJJJlOL9ZOo","gender": "O","data": [{"id": "0","segment": [{"id": "1","value": "0"}]}, {"id": "1234","segment": [{"id": "4444555","value": "0"}]}]},"test": 0,"at": 1,"tmax": 150,"wseat": ["1234"],"cur": ["USD"],"bcat": ["IAB23-7", "IAB23-5", "IAB23-10", "IAB23-9", "IAB23-1", "IAB7-44", "IAB9-9", "IAB8-18", "IAB8-5"],"badv": ["url1.com", "url2.com"],"ext": {"appnexus": {"seller_member_id": 123,"spend_protection": true,"publisher_integration": {"is_header": 0,"bid_shading_high": 1,"bid_shading_medium": 0.35,"bid_shading_low": 0.95}}},"source": {"fd": 1,"tid": "2dd111ff-7777-4abc-8558-86a123ab46d6"}}
	
	RTB Appnexus Request             ${RTB_APPNEXUS_API}         ${data}   
    RTB Basic Validation Appnexus			auction_id=${random_auction_id_64}			creative_id=${mw_ag_banner}		
    #Set Test Variable      ${ad_request_url}		${AD_PICKUP_URL}/${appnexus_auction_id}?price=0.81
    #Validate Ad Serving  ad_url=${ad_request_url}    	image_name=banner_67689_image_4INFO_320x50.gif   location=${DEFAULT_BROWSER_HOME}
    #Capture Page Screenshot With Timestamp
 	[Tags] 		Exclude

Appnexus - Placement Discovery via Site ID
	[Documentation]		QA_REGRESSION_TESTS>34_Placement_Discovery (appnexus site_id must be a number 112233445566)
	Set Test Variable	${site_bundle}			Nothing
	Set Test Variable	${site_domain}			Nothing.com
	Set Test Variable	${site_cat}				Nothing
	Set Test Variable	${site_id}				112233445566
	Set Test Variable	${site_publisher_id}		1000000
	Set Test Variable	${site_storeurl}			Nothing
	${random_auction_id_64}=         Generate Random String 		15		123456789
	#Set Test Variable    ${data}   		  {"bid_request":{"timestamp":"2016-12-15 21:52:51","bidder_timeout_ms":100,"members":[{"id":2049}],"member_ad_profile_id":163870,"excluded_technical_attributes":[33],"tags":[{"auction_id_64":${random_auction_id_64},"smaller_sizes_allowed":false,"position":"unknown","tag_format":"iframe","ad_profile_id":928663,"visibility_profile_id":8181,"allowed_media_types":[1],"media_subtypes":["banner"],"predicted_view_rate":0.21,"size":"320x50","sizes":["320x50","320x100"],"estimated_clear_price":6.20000,"estimated_average_price":2.0800,"id":9852411,"site_id":"${site_id}","venue_id":1511282,"inventory_audits":[{"auditor_member_id":1908,"intended_audience":"general","content_categories":[32424,32429,32430,36102]}],"deals_only":false,"predicted_engagement_rates":[{"engagement_rate_type":"video_completion","rate":1.00}]}],"bid_info":{"no_cookies":true,"payment_rule_id":1101471,"no_flash":false,"certified_supply":true,"spend_protection":true,"browser":12,"operating_system":8,"operating_system_extended":160,"operating_system_family":3,"carrier":1,"device_make":26,"device_type":2,"language":1,"session_freq":1,"pub_session_freq":1,"country":"US","within_iframe":false,"selling_member_id":1908,"publisher_id":${site_publisher_id},"user_id_64":0,"ip_address":"174.59.130.115","user_agent":"Mozilla/5.0 (iPhone; CPU iPhone OS 10_1_1 like Mac OS X) AppleWebKit/602.2.14 (KHTML, like Gecko) Version/10.0 Mobile/14B100 Safari/602.1","accepted_languages":"en-us","region":"PA","city":"Elizabethville","postal_code":"17023","postal_code_id":12355,"dma":566,"time_zone":"America/Indiana/Vevay","url":"http://colleges.startclass.com/compare/3624-3683/Elizabethtown-College-vs-Lebanon-Valley-College","domain":"${site_domain}","device_model":301,"inventory_url_id":1367861,"inventory_audits":[{"auditor_member_id":null,"intended_audience":"general","content_categories":[17,8302]}],"userdata_json":"{}"}}}	
	Set Test Variable    ${data}			{"id": "8765482113786061111","imp": [{"id": "${random_auction_id_64}","banner": {"w": 320,"h": 50,"id": "1","battr": [1, 2, 15],"pos": 0,"format": [{"w": 320,"h": 50}]},"instl": 0,"tagid": "12347654","secure": 1,"ext": {"appnexus": {"estimated_clear_price": 0.57,"predicted_view_rate": 0.073255,"member_ad_profile_id": 1111055,"predicted_video_completion_rate": 0.592172,"predicted_view_rate_over_total": 0.067229,"allowed_payment_types": [{"payment_type": 1,"imp_count_method": 2}]}}}],"site": {"id": "${site_id}","domain": "${site_domain}","cat": ["${site_cat}"],"bundle":"${site_bundle}","storeurl":"${site_storeurl}","page": "https://example.com/somepage.html","publisher": {"id": "${site_publisher_id}"}},"device": {"ua": "Mozilla/5.0 (Linux; Android 6.0.1; HUAWEI Build/MMB28B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Safari/537.36","geo": {"lat": 36.6203,"lon": -4.4998,"country": "US","region": "MA","metro": "1","city": "UnaCuidad","zip": "94110","utcoffset": 60,"ext": {"appnexus": {"timezone": "Africa/Ceuta"}}},"dnt": 0,"ip": "11.222.111.0","devicetype": 3,"ifa": "8d8ebc7c-77de-49d0-9519-51563b3909d2","make": "Unknown","model": "Generic Android Mobile","os": "Android","language": "es","connectiontype": 0},"user": {"id": "7939999668795769876","buyeruid": "CABBBBrbuQ9AA5DMJJJJlOL9ZOo","gender": "O","data": [{"id": "0","segment": [{"id": "1","value": "0"}]}, {"id": "1234","segment": [{"id": "4444555","value": "0"}]}]},"test": 0,"at": 1,"tmax": 150,"wseat": ["1234"],"cur": ["USD"],"bcat": ["IAB23-7", "IAB23-5", "IAB23-10", "IAB23-9", "IAB23-1", "IAB7-44", "IAB9-9", "IAB8-18", "IAB8-5"],"badv": ["url1.com", "url2.com"],"ext": {"appnexus": {"seller_member_id": 123,"spend_protection": true,"publisher_integration": {"is_header": 0,"bid_shading_high": 1,"bid_shading_medium": 0.35,"bid_shading_low": 0.95}}},"source": {"fd": 1,"tid": "2dd111ff-7777-4abc-8558-86a123ab46d6"}}
	
	RTB Appnexus Request             ${RTB_APPNEXUS_API}         ${data}   
    RTB Basic Validation Appnexus			auction_id=${random_auction_id_64}			creative_id=${mw_ag_banner}		
    #Set Test Variable      ${ad_request_url}		${AD_PICKUP_URL}/${appnexus_auction_id}?price=0.81
    #Validate Ad Serving  ad_url=${ad_request_url}    	image_name=banner_67689_image_4INFO_320x50.gif   location=${DEFAULT_BROWSER_HOME}
    #Capture Page Screenshot With Timestamp
 	[Tags] 		
	
Appnexus - Placement Discovery via Site Publisher ID
	[Documentation]		QA_REGRESSION_TESTS>34_Placement_Discovery (publisher_id must be a number 223344556677)
	Set Test Variable	${site_bundle}			Nothing
	Set Test Variable	${site_domain}			Nothing.com
	Set Test Variable	${site_cat}				Nothing
	Set Test Variable	${site_id}				1000000
	Set Test Variable	${site_publisher_id}		223344556677
	Set Test Variable	${site_storeurl}			Nothing
	${random_auction_id_64}=         Generate Random String 		15		123456789
	#Set Test Variable    ${data}   		  {"bid_request":{"timestamp":"2016-12-15 21:52:51","bidder_timeout_ms":100,"members":[{"id":2049}],"member_ad_profile_id":163870,"excluded_technical_attributes":[33],"tags":[{"auction_id_64":${random_auction_id_64},"smaller_sizes_allowed":false,"position":"unknown","tag_format":"iframe","ad_profile_id":928663,"visibility_profile_id":8181,"allowed_media_types":[1],"media_subtypes":["banner"],"predicted_view_rate":0.21,"size":"320x50","sizes":["320x50","320x100"],"estimated_clear_price":6.20000,"estimated_average_price":2.0800,"id":9852411,"site_id":"${site_id}","venue_id":1511282,"inventory_audits":[{"auditor_member_id":1908,"intended_audience":"general","content_categories":[32424,32429,32430,36102]}],"deals_only":false,"predicted_engagement_rates":[{"engagement_rate_type":"video_completion","rate":1.00}]}],"bid_info":{"no_cookies":true,"payment_rule_id":1101471,"no_flash":false,"certified_supply":true,"spend_protection":true,"browser":12,"operating_system":8,"operating_system_extended":160,"operating_system_family":3,"carrier":1,"device_make":26,"device_type":2,"language":1,"session_freq":1,"pub_session_freq":1,"country":"US","within_iframe":false,"selling_member_id":1908,"publisher_id":${site_publisher_id},"user_id_64":0,"ip_address":"174.59.130.115","user_agent":"Mozilla/5.0 (iPhone; CPU iPhone OS 10_1_1 like Mac OS X) AppleWebKit/602.2.14 (KHTML, like Gecko) Version/10.0 Mobile/14B100 Safari/602.1","accepted_languages":"en-us","region":"PA","city":"Elizabethville","postal_code":"17023","postal_code_id":12355,"dma":566,"time_zone":"America/Indiana/Vevay","url":"http://colleges.startclass.com/compare/3624-3683/Elizabethtown-College-vs-Lebanon-Valley-College","domain":"${site_domain}","device_model":301,"inventory_url_id":1367861,"inventory_audits":[{"auditor_member_id":null,"intended_audience":"general","content_categories":[17,8302]}],"userdata_json":"{}"}}}	
	Set Test Variable    ${data}			{"id": "8765482113786061111","imp": [{"id": "${random_auction_id_64}","banner": {"w": 320,"h": 50,"id": "1","battr": [1, 2, 15],"pos": 0,"format": [{"w": 320,"h": 50}]},"instl": 0,"tagid": "12347654","secure": 1,"ext": {"appnexus": {"estimated_clear_price": 0.57,"predicted_view_rate": 0.073255,"member_ad_profile_id": 1111055,"predicted_video_completion_rate": 0.592172,"predicted_view_rate_over_total": 0.067229,"allowed_payment_types": [{"payment_type": 1,"imp_count_method": 2}]}}}],"site": {"id": "${site_id}","domain": "${site_domain}","cat": ["${site_cat}"],"bundle":"${site_bundle}","storeurl":"${site_storeurl}","page": "https://example.com/somepage.html","publisher": {"id": "${site_publisher_id}"}},"device": {"ua": "Mozilla/5.0 (Linux; Android 6.0.1; HUAWEI Build/MMB28B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Safari/537.36","geo": {"lat": 36.6203,"lon": -4.4998,"country": "US","region": "MA","metro": "1","city": "UnaCuidad","zip": "94110","utcoffset": 60,"ext": {"appnexus": {"timezone": "Africa/Ceuta"}}},"dnt": 0,"ip": "11.222.111.0","devicetype": 3,"ifa": "8d8ebc7c-77de-49d0-9519-51563b3909d2","make": "Unknown","model": "Generic Android Mobile","os": "Android","language": "es","connectiontype": 0},"user": {"id": "7939999668795769876","buyeruid": "CABBBBrbuQ9AA5DMJJJJlOL9ZOo","gender": "O","data": [{"id": "0","segment": [{"id": "1","value": "0"}]}, {"id": "1234","segment": [{"id": "4444555","value": "0"}]}]},"test": 0,"at": 1,"tmax": 150,"wseat": ["1234"],"cur": ["USD"],"bcat": ["IAB23-7", "IAB23-5", "IAB23-10", "IAB23-9", "IAB23-1", "IAB7-44", "IAB9-9", "IAB8-18", "IAB8-5"],"badv": ["url1.com", "url2.com"],"ext": {"appnexus": {"seller_member_id": 123,"spend_protection": true,"publisher_integration": {"is_header": 0,"bid_shading_high": 1,"bid_shading_medium": 0.35,"bid_shading_low": 0.95}}},"source": {"fd": 1,"tid": "2dd111ff-7777-4abc-8558-86a123ab46d6"}}
	
	RTB Appnexus Request             ${RTB_APPNEXUS_API}         ${data}   
    RTB Basic Validation Appnexus			auction_id=${random_auction_id_64}			creative_id=${mw_ag_banner}		
 	[Tags] 	
	
Appnexus - Placement Discovery via Publisher ID Not MW (not serve)
	[Documentation]		QA_REGRESSION_TESTS>34_Placement_Discovery (publisher id must be a number 22334455667788)
	Set Test Variable	${site_bundle}			Nothing
	Set Test Variable	${site_domain}			Nothing.com
	Set Test Variable	${site_cat}				Nothing
	Set Test Variable	${site_id}				100000
	Set Test Variable	${site_publisher_id}		22334455667788
	Set Test Variable	${site_storeurl}			Nothing
	${random_auction_id_64}=         Generate Random String 		15		123456789
	#Set Test Variable    ${data}   		  {"bid_request":{"timestamp":"2016-12-15 21:52:51","bidder_timeout_ms":100,"members":[{"id":2049}],"member_ad_profile_id":163870,"excluded_technical_attributes":[33],"tags":[{"auction_id_64":${random_auction_id_64},"smaller_sizes_allowed":false,"position":"unknown","tag_format":"iframe","ad_profile_id":928663,"visibility_profile_id":8181,"allowed_media_types":[1],"media_subtypes":["banner"],"predicted_view_rate":0.21,"size":"320x50","sizes":["320x50","320x100"],"estimated_clear_price":6.20000,"estimated_average_price":2.0800,"id":9852411,"site_id":"${site_id}","venue_id":1511282,"inventory_audits":[{"auditor_member_id":1908,"intended_audience":"general","content_categories":[32424,32429,32430,36102]}],"deals_only":false,"predicted_engagement_rates":[{"engagement_rate_type":"video_completion","rate":1.00}]}],"bid_info":{"no_cookies":true,"payment_rule_id":1101471,"no_flash":false,"certified_supply":true,"spend_protection":true,"browser":12,"operating_system":8,"operating_system_extended":160,"operating_system_family":3,"carrier":1,"device_make":26,"device_type":2,"language":1,"session_freq":1,"pub_session_freq":1,"country":"US","within_iframe":false,"selling_member_id":1908,"publisher_id":${site_publisher_id},"user_id_64":0,"ip_address":"174.59.130.115","user_agent":"Mozilla/5.0 (iPhone; CPU iPhone OS 10_1_1 like Mac OS X) AppleWebKit/602.2.14 (KHTML, like Gecko) Version/10.0 Mobile/14B100 Safari/602.1","accepted_languages":"en-us","region":"PA","city":"Elizabethville","postal_code":"17023","postal_code_id":12355,"dma":566,"time_zone":"America/Indiana/Vevay","url":"http://colleges.startclass.com/compare/3624-3683/Elizabethtown-College-vs-Lebanon-Valley-College","domain":"${site_domain}","device_model":301,"inventory_url_id":1367861,"inventory_audits":[{"auditor_member_id":null,"intended_audience":"general","content_categories":[17,8302]}],"userdata_json":"{}"}}}	
	Set Test Variable    ${data}			{"id": "8765482113786061111","imp": [{"id": "${random_auction_id_64}","banner": {"w": 320,"h": 50,"id": "1","battr": [1, 2, 15],"pos": 0,"format": [{"w": 320,"h": 50}]},"instl": 0,"tagid": "12347654","secure": 1,"ext": {"appnexus": {"estimated_clear_price": 0.57,"predicted_view_rate": 0.073255,"member_ad_profile_id": 1111055,"predicted_video_completion_rate": 0.592172,"predicted_view_rate_over_total": 0.067229,"allowed_payment_types": [{"payment_type": 1,"imp_count_method": 2}]}}}],"site": {"id": "${site_id}","domain": "${site_domain}","cat": ["${site_cat}"],"bundle":"${site_bundle}","storeurl":"${site_storeurl}","page": "https://example.com/somepage.html","publisher": {"id": "${site_publisher_id}"}},"device": {"ua": "Mozilla/5.0 (Linux; Android 6.0.1; HUAWEI Build/MMB28B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Safari/537.36","geo": {"lat": 36.6203,"lon": -4.4998,"country": "US","region": "MA","metro": "1","city": "UnaCuidad","zip": "94110","utcoffset": 60,"ext": {"appnexus": {"timezone": "Africa/Ceuta"}}},"dnt": 0,"ip": "11.222.111.0","devicetype": 3,"ifa": "8d8ebc7c-77de-49d0-9519-51563b3909d2","make": "Unknown","model": "Generic Android Mobile","os": "Android","language": "es","connectiontype": 0},"user": {"id": "7939999668795769876","buyeruid": "CABBBBrbuQ9AA5DMJJJJlOL9ZOo","gender": "O","data": [{"id": "0","segment": [{"id": "1","value": "0"}]}, {"id": "1234","segment": [{"id": "4444555","value": "0"}]}]},"test": 0,"at": 1,"tmax": 150,"wseat": ["1234"],"cur": ["USD"],"bcat": ["IAB23-7", "IAB23-5", "IAB23-10", "IAB23-9", "IAB23-1", "IAB7-44", "IAB9-9", "IAB8-18", "IAB8-5"],"badv": ["url1.com", "url2.com"],"ext": {"appnexus": {"seller_member_id": 123,"spend_protection": true,"publisher_integration": {"is_header": 0,"bid_shading_high": 1,"bid_shading_medium": 0.35,"bid_shading_low": 0.95}}},"source": {"fd": 1,"tid": "2dd111ff-7777-4abc-8558-86a123ab46d6"}}
	
	RTB Appnexus Request 				API=${RTB_APPNEXUS_API}          data=${data}		response_code=no_bid        submit_client_impression_event=NO
	[Tags] 	

Appnexus - Placement Discovery via Site Publisher Not App
	[Documentation]		QA_REGRESSION_TESTS>34_Placement_Discovery ( pbulisher id: 2233445566778899)
	Set Test Variable	${site_bundle}			Nothing
	Set Test Variable	${site_domain}			Nothing.com
	Set Test Variable	${site_cat}				Nothing
	Set Test Variable	${site_id}				100000
	Set Test Variable	${site_publisher_id}		2233445566778899
	Set Test Variable	${site_storeurl}			Nothing
	${random_auction_id_64}=         Generate Random String 		15		123456789
	#Set Test Variable    ${data}   		  {"bid_request":{"timestamp":"2016-12-15 21:52:51","bidder_timeout_ms":100,"members":[{"id":2049}],"member_ad_profile_id":163870,"excluded_technical_attributes":[33],"tags":[{"auction_id_64":${random_auction_id_64},"smaller_sizes_allowed":false,"position":"unknown","tag_format":"iframe","ad_profile_id":928663,"visibility_profile_id":8181,"allowed_media_types":[1],"media_subtypes":["banner"],"predicted_view_rate":0.21,"size":"320x50","sizes":["320x50","320x100"],"estimated_clear_price":6.20000,"estimated_average_price":2.0800,"id":9852411,"site_id":"${site_id}","venue_id":1511282,"inventory_audits":[{"auditor_member_id":1908,"intended_audience":"general","content_categories":[32424,32429,32430,36102]}],"deals_only":false,"predicted_engagement_rates":[{"engagement_rate_type":"video_completion","rate":1.00}]}],"bid_info":{"no_cookies":true,"payment_rule_id":1101471,"no_flash":false,"certified_supply":true,"spend_protection":true,"browser":12,"operating_system":8,"operating_system_extended":160,"operating_system_family":3,"carrier":1,"device_make":26,"device_type":2,"language":1,"session_freq":1,"pub_session_freq":1,"country":"US","within_iframe":false,"selling_member_id":1908,"publisher_id":${site_publisher_id},"user_id_64":0,"ip_address":"174.59.130.115","user_agent":"Mozilla/5.0 (iPhone; CPU iPhone OS 10_1_1 like Mac OS X) AppleWebKit/602.2.14 (KHTML, like Gecko) Version/10.0 Mobile/14B100 Safari/602.1","accepted_languages":"en-us","region":"PA","city":"Elizabethville","postal_code":"17023","postal_code_id":12355,"dma":566,"time_zone":"America/Indiana/Vevay","url":"http://colleges.startclass.com/compare/3624-3683/Elizabethtown-College-vs-Lebanon-Valley-College","domain":"${site_domain}","device_model":301,"inventory_url_id":1367861,"inventory_audits":[{"auditor_member_id":null,"intended_audience":"general","content_categories":[17,8302]}],"userdata_json":"{}"}}}	
	Set Test Variable    ${data}			{"id": "8765482113786061111","imp": [{"id": "${random_auction_id_64}","banner": {"w": 320,"h": 50,"id": "1","battr": [1, 2, 15],"pos": 0,"format": [{"w": 320,"h": 50}]},"instl": 0,"tagid": "12347654","secure": 1,"ext": {"appnexus": {"estimated_clear_price": 0.57,"predicted_view_rate": 0.073255,"member_ad_profile_id": 1111055,"predicted_video_completion_rate": 0.592172,"predicted_view_rate_over_total": 0.067229,"allowed_payment_types": [{"payment_type": 1,"imp_count_method": 2}]}}}],"site": {"id": "${site_id}","domain": "${site_domain}","cat": ["${site_cat}"],"bundle":"${site_bundle}","storeurl":"${site_storeurl}","page": "https://example.com/somepage.html","publisher": {"id": "${site_publisher_id}"}},"device": {"ua": "Mozilla/5.0 (Linux; Android 6.0.1; HUAWEI Build/MMB28B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Safari/537.36","geo": {"lat": 36.6203,"lon": -4.4998,"country": "US","region": "MA","metro": "1","city": "UnaCuidad","zip": "94110","utcoffset": 60,"ext": {"appnexus": {"timezone": "Africa/Ceuta"}}},"dnt": 0,"ip": "11.222.111.0","devicetype": 3,"ifa": "8d8ebc7c-77de-49d0-9519-51563b3909d2","make": "Unknown","model": "Generic Android Mobile","os": "Android","language": "es","connectiontype": 0},"user": {"id": "7939999668795769876","buyeruid": "CABBBBrbuQ9AA5DMJJJJlOL9ZOo","gender": "O","data": [{"id": "0","segment": [{"id": "1","value": "0"}]}, {"id": "1234","segment": [{"id": "4444555","value": "0"}]}]},"test": 0,"at": 1,"tmax": 150,"wseat": ["1234"],"cur": ["USD"],"bcat": ["IAB23-7", "IAB23-5", "IAB23-10", "IAB23-9", "IAB23-1", "IAB7-44", "IAB9-9", "IAB8-18", "IAB8-5"],"badv": ["url1.com", "url2.com"],"ext": {"appnexus": {"seller_member_id": 123,"spend_protection": true,"publisher_integration": {"is_header": 0,"bid_shading_high": 1,"bid_shading_medium": 0.35,"bid_shading_low": 0.95}}},"source": {"fd": 1,"tid": "2dd111ff-7777-4abc-8558-86a123ab46d6"}}
	
	RTB Appnexus Request             ${RTB_APPNEXUS_API}         ${data}   
    RTB Basic Validation Appnexus			auction_id=${random_auction_id_64}			creative_id=${mw_ag_banner}		
 	[Tags] 	

Appnexus - Placement Discovery via Site Publisher Not Online
	[Documentation]		QA_REGRESSION_TESTS>34_Placement_Discovery (publisher ID:  223344556677889900)
	Set Test Variable	${site_bundle}			Nothing
	Set Test Variable	${site_domain}			Nothing.com
	Set Test Variable	${site_cat}				Nothing
	Set Test Variable	${site_id}				100000
	Set Test Variable	${site_publisher_id}		223344556677889900
	Set Test Variable	${site_storeurl}			Nothing
	${random_auction_id_64}=         Generate Random String 		15		123456789
	#Set Test Variable    ${data}   		  {"bid_request":{"timestamp":"2016-12-15 21:52:51","bidder_timeout_ms":100,"members":[{"id":2049}],"member_ad_profile_id":163870,"excluded_technical_attributes":[33],"tags":[{"auction_id_64":${random_auction_id_64},"smaller_sizes_allowed":false,"position":"unknown","tag_format":"iframe","ad_profile_id":928663,"visibility_profile_id":8181,"allowed_media_types":[1],"media_subtypes":["banner"],"predicted_view_rate":0.21,"size":"320x50","sizes":["320x50","320x100"],"estimated_clear_price":6.20000,"estimated_average_price":2.0800,"id":9852411,"site_id":"${site_id}","venue_id":1511282,"inventory_audits":[{"auditor_member_id":1908,"intended_audience":"general","content_categories":[32424,32429,32430,36102]}],"deals_only":false,"predicted_engagement_rates":[{"engagement_rate_type":"video_completion","rate":1.00}]}],"bid_info":{"no_cookies":true,"payment_rule_id":1101471,"no_flash":false,"certified_supply":true,"spend_protection":true,"browser":12,"operating_system":8,"operating_system_extended":160,"operating_system_family":3,"carrier":1,"device_make":26,"device_type":2,"language":1,"session_freq":1,"pub_session_freq":1,"country":"US","within_iframe":false,"selling_member_id":1908,"publisher_id":${site_publisher_id},"user_id_64":0,"ip_address":"174.59.130.115","user_agent":"Mozilla/5.0 (iPhone; CPU iPhone OS 10_1_1 like Mac OS X) AppleWebKit/602.2.14 (KHTML, like Gecko) Version/10.0 Mobile/14B100 Safari/602.1","accepted_languages":"en-us","region":"PA","city":"Elizabethville","postal_code":"17023","postal_code_id":12355,"dma":566,"time_zone":"America/Indiana/Vevay","url":"http://colleges.startclass.com/compare/3624-3683/Elizabethtown-College-vs-Lebanon-Valley-College","domain":"${site_domain}","device_model":301,"inventory_url_id":1367861,"inventory_audits":[{"auditor_member_id":null,"intended_audience":"general","content_categories":[17,8302]}],"userdata_json":"{}"}}}	
	Set Test Variable    ${data}			{"id": "8765482113786061111","imp": [{"id": "${random_auction_id_64}","banner": {"w": 320,"h": 50,"id": "1","battr": [1, 2, 15],"pos": 0,"format": [{"w": 320,"h": 50}]},"instl": 0,"tagid": "12347654","secure": 1,"ext": {"appnexus": {"estimated_clear_price": 0.57,"predicted_view_rate": 0.073255,"member_ad_profile_id": 1111055,"predicted_video_completion_rate": 0.592172,"predicted_view_rate_over_total": 0.067229,"allowed_payment_types": [{"payment_type": 1,"imp_count_method": 2}]}}}],"site": {"id": "${site_id}","domain": "${site_domain}","cat": ["${site_cat}"],"bundle":"${site_bundle}","storeurl":"${site_storeurl}","page": "https://example.com/somepage.html","publisher": {"id": "${site_publisher_id}"}},"device": {"ua": "Mozilla/5.0 (Linux; Android 6.0.1; HUAWEI Build/MMB28B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Safari/537.36","geo": {"lat": 36.6203,"lon": -4.4998,"country": "US","region": "MA","metro": "1","city": "UnaCuidad","zip": "94110","utcoffset": 60,"ext": {"appnexus": {"timezone": "Africa/Ceuta"}}},"dnt": 0,"ip": "11.222.111.0","devicetype": 3,"ifa": "8d8ebc7c-77de-49d0-9519-51563b3909d2","make": "Unknown","model": "Generic Android Mobile","os": "Android","language": "es","connectiontype": 0},"user": {"id": "7939999668795769876","buyeruid": "CABBBBrbuQ9AA5DMJJJJlOL9ZOo","gender": "O","data": [{"id": "0","segment": [{"id": "1","value": "0"}]}, {"id": "1234","segment": [{"id": "4444555","value": "0"}]}]},"test": 0,"at": 1,"tmax": 150,"wseat": ["1234"],"cur": ["USD"],"bcat": ["IAB23-7", "IAB23-5", "IAB23-10", "IAB23-9", "IAB23-1", "IAB7-44", "IAB9-9", "IAB8-18", "IAB8-5"],"badv": ["url1.com", "url2.com"],"ext": {"appnexus": {"seller_member_id": 123,"spend_protection": true,"publisher_integration": {"is_header": 0,"bid_shading_high": 1,"bid_shading_medium": 0.35,"bid_shading_low": 0.95}}},"source": {"fd": 1,"tid": "2dd111ff-7777-4abc-8558-86a123ab46d6"}}
	
	RTB Appnexus Request             ${RTB_APPNEXUS_API}         ${data}   
    RTB Basic Validation Appnexus			auction_id=${random_auction_id_64}			creative_id=${mw_ag_banner}		
 	[Tags] 	



Appnexus - Placement Discovery via Online Domain
	[Documentation]		QA_REGRESSION_TESTS>34_Placement_Discovery (OnlineDomain.com)
	Set Test Variable	${online_bundle}			Nothing
	Set Test Variable	${online_domain}			OnlineDomain.com
	Set Test Variable	${online_cat}				Nothing
	Set Test Variable	${online_id}				100000
	Set Test Variable	${online_publisher_id}		100000
	Set Test Variable	${online_storeurl}			Nothing
	${random_auction_id_64}=         Generate Random String 		15		123456789
	#Set Test Variable    ${data}   		  {"bid_request":{"timestamp":"2016-12-16 02:22:56","bidder_timeout_ms":100,"members":[{"id":2049}],"member_ad_profile_id":135907,"excluded_technical_attributes":[33],"tags":[{"auction_id_64":${random_auction_id_64},"smaller_sizes_allowed":false,"position":"above","ad_profile_id":845416,"visibility_profile_id":779,"pop_max_width":300,"pop_max_height":250,"allowed_media_types":[1],"media_subtypes":["banner"],"predicted_view_rate":0.09,"size":"320x50","sizes":["320x50"],"estimated_clear_price":1.50000,"estimated_average_price":1.2600,"id":6191137,"site_id":${online_id},"venue_id":1487157,"inventory_audits":[{"auditor_member_id":1705,"intended_audience":"general"}],"deals_only":false,"predicted_engagement_rates":[{"engagement_rate_type":"video_completion","rate":1.00}]}],"bid_info":{"no_cookies":false,"payment_rule_id":896824,"no_flash":false,"certified_supply":true,"spend_protection":true,"browser":7,"operating_system":5,"operating_system_extended":137,"operating_system_family":5,"carrier":358,"device_type":1,"language":1,"session_freq":381,"pub_session_freq":281,"country":"US","within_iframe":false,"selling_member_id":2801,"user_id_64":7442994412279874583,"ip_address":"107.13.141.210","user_agent":"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:51.0) Gecko/20100101 Firefox/51.0","accepted_languages":"en-US,en;q=0.5","region":"NC","city":"Durham","postal_code":"27713","postal_code_id":20483,"dma":560,"time_zone":"America/Indiana/Vevay","url":"http://live.cricket.com.au/","domain":"${online_domain}","inventory_url_id":873873,"inventory_audits":[{"auditor_member_id":null,"intended_audience":"general","inventory_attributes":[4,8,16],"content_categories":[29,8536]}],"userdata_json":"{}","segments":[{"id":1,"member_id":0,"code":"cookie_birthday","provider":"Appnexus","last_seen_min":24696769}]}}}
	Set Test Variable    ${data}			{"id": "8765482113786061111","imp": [{"id": "${random_auction_id_64}","banner": {"w": 320,"h": 50,"id": "1","battr": [1, 2, 15],"pos": 0,"format": [{"w": 320,"h": 50}]},"instl": 0,"tagid": "12347654","secure": 1,"ext": {"appnexus": {"estimated_clear_price": 0.57,"predicted_view_rate": 0.073255,"member_ad_profile_id": 1111055,"predicted_video_completion_rate": 0.592172,"predicted_view_rate_over_total": 0.067229,"allowed_payment_types": [{"payment_type": 1,"imp_count_method": 2}]}}}],"site": {"id": "${online_id}","domain": "${online_domain}","cat": ["${online_cat}"],"bundle":"${online_bundle}","storeurl":"${online_storeurl}","page": "https://example.com/somepage.html","publisher": {"id": "${online_publisher_id}"}},"device": {"ua": "Mozilla/5.0 (Linux; Android 6.0.1; HUAWEI Build/MMB28B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Safari/537.36","geo": {"lat": 36.6203,"lon": -4.4998,"country": "US","region": "MA","metro": "1","city": "UnaCuidad","zip": "94110","utcoffset": 60,"ext": {"appnexus": {"timezone": "Africa/Ceuta"}}},"dnt": 0,"ip": "11.222.111.0","devicetype": 3,"ifa": "8d8ebc7c-77de-49d0-9519-51563b3909d2","make": "Unknown","model": "Generic Android Mobile","os": "Android","language": "es","connectiontype": 0},"user": {"id": "7939999668795769876","buyeruid": "CABBBBrbuQ9AA5DMJJJJlOL9ZOo","gender": "O","data": [{"id": "0","segment": [{"id": "1","value": "0"}]}, {"id": "1234","segment": [{"id": "4444555","value": "0"}]}]},"test": 0,"at": 1,"tmax": 150,"wseat": ["1234"],"cur": ["USD"],"bcat": ["IAB23-7", "IAB23-5", "IAB23-10", "IAB23-9", "IAB23-1", "IAB7-44", "IAB9-9", "IAB8-18", "IAB8-5"],"badv": ["url1.com", "url2.com"],"ext": {"appnexus": {"seller_member_id": 123,"spend_protection": true,"publisher_integration": {"is_header": 0,"bid_shading_high": 1,"bid_shading_medium": 0.35,"bid_shading_low": 0.95}}},"source": {"fd": 1,"tid": "2dd111ff-7777-4abc-8558-86a123ab46d6"}}
	
	RTB Appnexus Request             ${RTB_APPNEXUS_API}         ${data}   
    RTB Basic Validation Appnexus			auction_id=${random_auction_id_64}			creative_id=${online_ag_banner}		
	[Tags] 		

Appnexus - Placement Discovery via Online IAB Category
	[Documentation]		QA_REGRESSION_TESTS>34_Placement_Discovery (appnexus does not have iab cat)
	Set Test Variable	${online_bundle}			Nothing
	Set Test Variable	${online_domain}			OnlineDomain.com
	Set Test Variable	${online_cat}				Nothing
	Set Test Variable	${online_id}				Nothing
	Set Test Variable	${online_publisher_id}		100000
	Set Test Variable	${online_storeurl}			Nothing
	${random_auction_id_64}=         Generate Random String 		15		123456789
	Set Test Variable    ${data}			{"id": "8765482113786061111","imp": [{"id": "${random_auction_id_64}","banner": {"w": 320,"h": 50,"id": "1","battr": [1, 2, 15],"pos": 0,"format": [{"w": 320,"h": 50}]},"instl": 0,"tagid": "12347654","secure": 1,"ext": {"appnexus": {"estimated_clear_price": 0.57,"predicted_view_rate": 0.073255,"member_ad_profile_id": 1111055,"predicted_video_completion_rate": 0.592172,"predicted_view_rate_over_total": 0.067229,"allowed_payment_types": [{"payment_type": 1,"imp_count_method": 2}]}}}],"site": {"id": "${online_id}","domain": "${online_domain}","cat": ["${online_cat}"],"bundle":"${online_bundle}","storeurl":"${online_storeurl}","page": "https://example.com/somepage.html","publisher": {"id": "${online_publisher_id}"}},"device": {"ua": "Mozilla/5.0 (Linux; Android 6.0.1; HUAWEI Build/MMB28B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Safari/537.36","geo": {"lat": 36.6203,"lon": -4.4998,"country": "US","region": "MA","metro": "1","city": "UnaCuidad","zip": "94110","utcoffset": 60,"ext": {"appnexus": {"timezone": "Africa/Ceuta"}}},"dnt": 0,"ip": "11.222.111.0","devicetype": 3,"ifa": "8d8ebc7c-77de-49d0-9519-51563b3909d2","make": "Unknown","model": "Generic Android Mobile","os": "Android","language": "es","connectiontype": 0},"user": {"id": "7939999668795769876","buyeruid": "CABBBBrbuQ9AA5DMJJJJlOL9ZOo","gender": "O","data": [{"id": "0","segment": [{"id": "1","value": "0"}]}, {"id": "1234","segment": [{"id": "4444555","value": "0"}]}]},"test": 0,"at": 1,"tmax": 150,"wseat": ["1234"],"cur": ["USD"],"bcat": ["IAB23-7", "IAB23-5", "IAB23-10", "IAB23-9", "IAB23-1", "IAB7-44", "IAB9-9", "IAB8-18", "IAB8-5"],"badv": ["url1.com", "url2.com"],"ext": {"appnexus": {"seller_member_id": 123,"spend_protection": true,"publisher_integration": {"is_header": 0,"bid_shading_high": 1,"bid_shading_medium": 0.35,"bid_shading_low": 0.95}}},"source": {"fd": 1,"tid": "2dd111ff-7777-4abc-8558-86a123ab46d6"}}
	
	RTB Appnexus Request             ${RTB_APPNEXUS_API}         ${data}   
    RTB Basic Validation Appnexus			auction_id=${random_auction_id_64}			creative_id=${online_ag_banner}		
	[Tags] 		Exclude

Appnexus - Placement Discovery via Online ID (Still using Site ID)
	[Documentation]		QA_REGRESSION_TESTS>34_Placement_Discovery (id must be a number)
	Set Test Variable	${online_bundle}			Nothing
	Set Test Variable	${online_domain}			Nothing.com
	Set Test Variable	${online_cat}				Nothing
	Set Test Variable	${online_id}				334455
	Set Test Variable	${online_publisher_id}		100000
	Set Test Variable	${online_storeurl}			Nothing
	${random_auction_id_64}=         Generate Random String 		15		123456789
	Set Test Variable    ${data}			{"id": "8765482113786061111","imp": [{"id": "${random_auction_id_64}","banner": {"w": 320,"h": 50,"id": "1","battr": [1, 2, 15],"pos": 0,"format": [{"w": 320,"h": 50}]},"instl": 0,"tagid": "12347654","secure": 1,"ext": {"appnexus": {"estimated_clear_price": 0.57,"predicted_view_rate": 0.073255,"member_ad_profile_id": 1111055,"predicted_video_completion_rate": 0.592172,"predicted_view_rate_over_total": 0.067229,"allowed_payment_types": [{"payment_type": 1,"imp_count_method": 2}]}}}],"site": {"id": "${online_id}","domain": "${online_domain}","cat": ["${online_cat}"],"bundle":"${online_bundle}","storeurl":"${online_storeurl}","page": "https://example.com/somepage.html","publisher": {"id": "${online_publisher_id}"}},"device": {"ua": "Mozilla/5.0 (Linux; Android 6.0.1; HUAWEI Build/MMB28B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Safari/537.36","geo": {"lat": 36.6203,"lon": -4.4998,"country": "US","region": "MA","metro": "1","city": "UnaCuidad","zip": "94110","utcoffset": 60,"ext": {"appnexus": {"timezone": "Africa/Ceuta"}}},"dnt": 0,"ip": "11.222.111.0","devicetype": 3,"ifa": "8d8ebc7c-77de-49d0-9519-51563b3909d2","make": "Unknown","model": "Generic Android Mobile","os": "Android","language": "es","connectiontype": 0},"user": {"id": "7939999668795769876","buyeruid": "CABBBBrbuQ9AA5DMJJJJlOL9ZOo","gender": "O","data": [{"id": "0","segment": [{"id": "1","value": "0"}]}, {"id": "1234","segment": [{"id": "4444555","value": "0"}]}]},"test": 0,"at": 1,"tmax": 150,"wseat": ["1234"],"cur": ["USD"],"bcat": ["IAB23-7", "IAB23-5", "IAB23-10", "IAB23-9", "IAB23-1", "IAB7-44", "IAB9-9", "IAB8-18", "IAB8-5"],"badv": ["url1.com", "url2.com"],"ext": {"appnexus": {"seller_member_id": 123,"spend_protection": true,"publisher_integration": {"is_header": 0,"bid_shading_high": 1,"bid_shading_medium": 0.35,"bid_shading_low": 0.95}}},"source": {"fd": 1,"tid": "2dd111ff-7777-4abc-8558-86a123ab46d6"}}
	
	RTB Appnexus Request             ${RTB_APPNEXUS_API}         ${data}   
    RTB Basic Validation Appnexus			auction_id=${random_auction_id_64}			creative_id=${online_ag_banner}		
	[Tags] 		
	
Appnexus - Placement Discovery via Online Publisher ID
	[Documentation]		QA_REGRESSION_TESTS>34_Placement_Discovery (Online does not use publisher ID. Publisher ID must be a number 3333222211111)
	Set Test Variable	${online_bundle}			Nothing
	Set Test Variable	${online_domain}			Nothing.com
	Set Test Variable	${online_cat}				Nothing
	Set Test Variable	${online_id}				Nothing
	Set Test Variable	${online_publisher_id}		3333222211111
	Set Test Variable	${online_storeurl}			Nothing
	${random_auction_id_64}=         Generate Random String 		15		123456789
	Set Test Variable    ${data}			{"id": "8765482113786061111","imp": [{"id": "${random_auction_id_64}","banner": {"w": 320,"h": 50,"id": "1","battr": [1, 2, 15],"pos": 0,"format": [{"w": 320,"h": 50}]},"instl": 0,"tagid": "12347654","secure": 1,"ext": {"appnexus": {"estimated_clear_price": 0.57,"predicted_view_rate": 0.073255,"member_ad_profile_id": 1111055,"predicted_video_completion_rate": 0.592172,"predicted_view_rate_over_total": 0.067229,"allowed_payment_types": [{"payment_type": 1,"imp_count_method": 2}]}}}],"site": {"id": "${online_id}","domain": "${online_domain}","cat": ["${online_cat}"],"bundle":"${online_bundle}","storeurl":"${online_storeurl}","page": "https://example.com/somepage.html","publisher": {"id": "${online_publisher_id}"}},"device": {"ua": "Mozilla/5.0 (Linux; Android 6.0.1; HUAWEI Build/MMB28B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Safari/537.36","geo": {"lat": 36.6203,"lon": -4.4998,"country": "US","region": "MA","metro": "1","city": "UnaCuidad","zip": "94110","utcoffset": 60,"ext": {"appnexus": {"timezone": "Africa/Ceuta"}}},"dnt": 0,"ip": "11.222.111.0","devicetype": 3,"ifa": "8d8ebc7c-77de-49d0-9519-51563b3909d2","make": "Unknown","model": "Generic Android Mobile","os": "Android","language": "es","connectiontype": 0},"user": {"id": "7939999668795769876","buyeruid": "CABBBBrbuQ9AA5DMJJJJlOL9ZOo","gender": "O","data": [{"id": "0","segment": [{"id": "1","value": "0"}]}, {"id": "1234","segment": [{"id": "4444555","value": "0"}]}]},"test": 0,"at": 1,"tmax": 150,"wseat": ["1234"],"cur": ["USD"],"bcat": ["IAB23-7", "IAB23-5", "IAB23-10", "IAB23-9", "IAB23-1", "IAB7-44", "IAB9-9", "IAB8-18", "IAB8-5"],"badv": ["url1.com", "url2.com"],"ext": {"appnexus": {"seller_member_id": 123,"spend_protection": true,"publisher_integration": {"is_header": 0,"bid_shading_high": 1,"bid_shading_medium": 0.35,"bid_shading_low": 0.95}}},"source": {"fd": 1,"tid": "2dd111ff-7777-4abc-8558-86a123ab46d6"}}
	
	RTB Appnexus Request             ${RTB_APPNEXUS_API}         ${data}   
    RTB Basic Validation Appnexus			auction_id=${random_auction_id_64}			creative_id=${online_ag_banner}		
	[Tags] 		EXCLUDE
	
Appnexus - Placement Discovery via Publisher ID Not Online
	[Documentation]		QA_REGRESSION_TESTS>34_Placement_Discovery( Online does not use publisher id.  publisher id must be a number 223344556677889900
	Set Test Variable	${online_bundle}			Nothing
	Set Test Variable	${online_domain}			Nothing.com
	Set Test Variable	${online_cat}				Nothing
	Set Test Variable	${online_id}				Nothing
	Set Test Variable	${online_publisher_id}		223344556677889900
	Set Test Variable	${online_storeurl}			Nothing
	${random_auction_id_64}=         Generate Random String 		15		123456789
	Set Test Variable    ${data}			{"id": "8765482113786061111","imp": [{"id": "${random_auction_id_64}","banner": {"w": 320,"h": 50,"id": "1","battr": [1, 2, 15],"pos": 0,"format": [{"w": 320,"h": 50}]},"instl": 0,"tagid": "12347654","secure": 1,"ext": {"appnexus": {"estimated_clear_price": 0.57,"predicted_view_rate": 0.073255,"member_ad_profile_id": 1111055,"predicted_video_completion_rate": 0.592172,"predicted_view_rate_over_total": 0.067229,"allowed_payment_types": [{"payment_type": 1,"imp_count_method": 2}]}}}],"site": {"id": "${online_id}","domain": "${online_domain}","cat": ["${online_cat}"],"bundle":"${online_bundle}","storeurl":"${online_storeurl}","page": "https://example.com/somepage.html","publisher": {"id": "${online_publisher_id}"}},"device": {"ua": "Mozilla/5.0 (Linux; Android 6.0.1; HUAWEI Build/MMB28B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Safari/537.36","geo": {"lat": 36.6203,"lon": -4.4998,"country": "US","region": "MA","metro": "1","city": "UnaCuidad","zip": "94110","utcoffset": 60,"ext": {"appnexus": {"timezone": "Africa/Ceuta"}}},"dnt": 0,"ip": "11.222.111.0","devicetype": 3,"ifa": "8d8ebc7c-77de-49d0-9519-51563b3909d2","make": "Unknown","model": "Generic Android Mobile","os": "Android","language": "es","connectiontype": 0},"user": {"id": "7939999668795769876","buyeruid": "CABBBBrbuQ9AA5DMJJJJlOL9ZOo","gender": "O","data": [{"id": "0","segment": [{"id": "1","value": "0"}]}, {"id": "1234","segment": [{"id": "4444555","value": "0"}]}]},"test": 0,"at": 1,"tmax": 150,"wseat": ["1234"],"cur": ["USD"],"bcat": ["IAB23-7", "IAB23-5", "IAB23-10", "IAB23-9", "IAB23-1", "IAB7-44", "IAB9-9", "IAB8-18", "IAB8-5"],"badv": ["url1.com", "url2.com"],"ext": {"appnexus": {"seller_member_id": 123,"spend_protection": true,"publisher_integration": {"is_header": 0,"bid_shading_high": 1,"bid_shading_medium": 0.35,"bid_shading_low": 0.95}}},"source": {"fd": 1,"tid": "2dd111ff-7777-4abc-8558-86a123ab46d6"}}
	
	RTB Appnexus Request             ${RTB_APPNEXUS_API}         ${data}   
    RTB Basic Validation Appnexus			auction_id=${random_auction_id_64}			creative_id=${online_ag_banner}		
	[Tags] 		exclude	

Appnexus - Placement Discovery via Publisher Not MW
	[Documentation]		QA_REGRESSION_TESTS>34_Placement_Discovery(publisher id must be a number 22334455667788)
	Set Test Variable	${online_bundle}			Nothing
	Set Test Variable	${online_domain}			Nothing.com
	Set Test Variable	${online_cat}				Nothing
	Set Test Variable	${online_id}				Nothing
	Set Test Variable	${online_publisher_id}		22334455667788
	Set Test Variable	${online_storeurl}			Nothing
	${random_auction_id_64}=         Generate Random String 		15		123456789
	Set Test Variable    ${data}			{"id": "8765482113786061111","imp": [{"id": "${random_auction_id_64}","banner": {"w": 320,"h": 50,"id": "1","battr": [1, 2, 15],"pos": 0,"format": [{"w": 320,"h": 50}]},"instl": 0,"tagid": "12347654","secure": 1,"ext": {"appnexus": {"estimated_clear_price": 0.57,"predicted_view_rate": 0.073255,"member_ad_profile_id": 1111055,"predicted_video_completion_rate": 0.592172,"predicted_view_rate_over_total": 0.067229,"allowed_payment_types": [{"payment_type": 1,"imp_count_method": 2}]}}}],"site": {"id": "${online_id}","domain": "${online_domain}","cat": ["${online_cat}"],"bundle":"${online_bundle}","storeurl":"${online_storeurl}","page": "https://example.com/somepage.html","publisher": {"id": "${online_publisher_id}"}},"device": {"ua": "Mozilla/5.0 (Linux; Android 6.0.1; HUAWEI Build/MMB28B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Safari/537.36","geo": {"lat": 36.6203,"lon": -4.4998,"country": "US","region": "MA","metro": "1","city": "UnaCuidad","zip": "94110","utcoffset": 60,"ext": {"appnexus": {"timezone": "Africa/Ceuta"}}},"dnt": 0,"ip": "11.222.111.0","devicetype": 3,"ifa": "8d8ebc7c-77de-49d0-9519-51563b3909d2","make": "Unknown","model": "Generic Android Mobile","os": "Android","language": "es","connectiontype": 0},"user": {"id": "7939999668795769876","buyeruid": "CABBBBrbuQ9AA5DMJJJJlOL9ZOo","gender": "O","data": [{"id": "0","segment": [{"id": "1","value": "0"}]}, {"id": "1234","segment": [{"id": "4444555","value": "0"}]}]},"test": 0,"at": 1,"tmax": 150,"wseat": ["1234"],"cur": ["USD"],"bcat": ["IAB23-7", "IAB23-5", "IAB23-10", "IAB23-9", "IAB23-1", "IAB7-44", "IAB9-9", "IAB8-18", "IAB8-5"],"badv": ["url1.com", "url2.com"],"ext": {"appnexus": {"seller_member_id": 123,"spend_protection": true,"publisher_integration": {"is_header": 0,"bid_shading_high": 1,"bid_shading_medium": 0.35,"bid_shading_low": 0.95}}},"source": {"fd": 1,"tid": "2dd111ff-7777-4abc-8558-86a123ab46d6"}}
	
	RTB Appnexus Request             ${RTB_APPNEXUS_API}         ${data}   
    RTB Basic Validation Appnexus			auction_id=${random_auction_id_64}			creative_id=${online_ag_banner}		
	[Tags] 		exclude
Appnexus - Placement Discovery via Publisher Not App
	[Documentation]		QA_REGRESSION_TESTS>34_Placement_Discovery (publisher id must be a number 2233445566778899)
	Set Test Variable	${online_bundle}			Nothing
	Set Test Variable	${online_domain}			Nothing.com
	Set Test Variable	${online_cat}				Nothing
	Set Test Variable	${online_id}				Nothing
	Set Test Variable	${online_publisher_id}		2233445566778899
	Set Test Variable	${online_storeurl}			Nothing
	${random_auction_id_64}=         Generate Random String 		15		123456789
	Set Test Variable    ${data}			{"id": "8765482113786061111","imp": [{"id": "${random_auction_id_64}","banner": {"w": 320,"h": 50,"id": "1","battr": [1, 2, 15],"pos": 0,"format": [{"w": 320,"h": 50}]},"instl": 0,"tagid": "12347654","secure": 1,"ext": {"appnexus": {"estimated_clear_price": 0.57,"predicted_view_rate": 0.073255,"member_ad_profile_id": 1111055,"predicted_video_completion_rate": 0.592172,"predicted_view_rate_over_total": 0.067229,"allowed_payment_types": [{"payment_type": 1,"imp_count_method": 2}]}}}],"site": {"id": "${online_id}","domain": "${online_domain}","cat": ["${online_cat}"],"bundle":"${online_bundle}","storeurl":"${online_storeurl}","page": "https://example.com/somepage.html","publisher": {"id": "${online_publisher_id}"}},"device": {"ua": "Mozilla/5.0 (Linux; Android 6.0.1; HUAWEI Build/MMB28B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Safari/537.36","geo": {"lat": 36.6203,"lon": -4.4998,"country": "US","region": "MA","metro": "1","city": "UnaCuidad","zip": "94110","utcoffset": 60,"ext": {"appnexus": {"timezone": "Africa/Ceuta"}}},"dnt": 0,"ip": "11.222.111.0","devicetype": 3,"ifa": "8d8ebc7c-77de-49d0-9519-51563b3909d2","make": "Unknown","model": "Generic Android Mobile","os": "Android","language": "es","connectiontype": 0},"user": {"id": "7939999668795769876","buyeruid": "CABBBBrbuQ9AA5DMJJJJlOL9ZOo","gender": "O","data": [{"id": "0","segment": [{"id": "1","value": "0"}]}, {"id": "1234","segment": [{"id": "4444555","value": "0"}]}]},"test": 0,"at": 1,"tmax": 150,"wseat": ["1234"],"cur": ["USD"],"bcat": ["IAB23-7", "IAB23-5", "IAB23-10", "IAB23-9", "IAB23-1", "IAB7-44", "IAB9-9", "IAB8-18", "IAB8-5"],"badv": ["url1.com", "url2.com"],"ext": {"appnexus": {"seller_member_id": 123,"spend_protection": true,"publisher_integration": {"is_header": 0,"bid_shading_high": 1,"bid_shading_medium": 0.35,"bid_shading_low": 0.95}}},"source": {"fd": 1,"tid": "2dd111ff-7777-4abc-8558-86a123ab46d6"}}
	
	RTB Appnexus Request             ${RTB_APPNEXUS_API}         ${data}   
    RTB Basic Validation Appnexus			auction_id=${random_auction_id_64}			creative_id=${online_ag_banner}		
	[Tags] 					exclude	