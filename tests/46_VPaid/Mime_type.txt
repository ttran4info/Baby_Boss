*** Settings ***
Resource   VPAID_specific_imports.txt
Force Tags           VPAID		MOPUB		BATCH3					

*** variables ***
${app_id}				13488
${mp4_ag}				41428	#country = usa
${mraid1_2_ag}			41429  #country = can
${mraid2_ag}			41430	#country = guam
*** Test Cases ***
Mopub - Mime type video/mp4
	[Documentation]		QA_REGRESSION_TESTS>05_RTB_Mopub>
	Set Test Variable	${mime_type} 		"video/3gpp", "video/3gpp2", "video/mp4", "video/quicktime", "video/x-m4v"
	Set Test Variable	${country}			USA
	Set Test Variable 	${data}			{"app": {"publisher": {"id": "505c3fa7cade4495a3aaf0b0e50e3880", "name": "Science Mobile, LLC"}, "ver": "4.2.0", "name": "Slingshot", "bundle": "1022441952", "cat": ["IAB24", "social_networking"], "id": "${app_id}", "storeurl": "https://itunes.apple.com/us/app/slingshot/id1022441952?mt=8"}, "imp": [{"bidfloor": 0.001, "tagid": "46137b023c87430c9296cccc531d7f31", "displaymanagerver": "3.8.0", "displaymanager": "mopub", "ext": {"secure": 0}, "video": {"protocol": 2, "mimes": [${mime_type}], "h": 320, "linearity": 1, "battr": [3, 8, 9, 10, 14], "api": [3, 5], "w": 480, "minduration": 0, "maxduration": 120, "protocols": [2, 5, 3, 6]}, "instl": 1, "banner": {"h": 50, "battr": [3, 8, 9, 10, 14], "pos": 1, "ext": {"nativebrowserclick": 1}, "api": [3, 5], "w": 320, "btype": [4]}, "id": "1"}], "at": 2, "device": {"geo": {"city": "Buffalo", "region": "NY", "metro": "514", "zip": "14218", "country": "${country}"}, "language": "en", "os": "iOS", "make": "Apple", "connectiontype": 2, "js": 1, "dpidsha1": "587607f6465cab44f448484f9be5283a4512f4cd", "dnt": 0, "ifa": "E236DAD5-07F7-415B-AC48-FA6C8698A051", "carrier": "310-120", "devicetype": 1, "ip": "76.180.53.26", "dpidmd5": "7f1d6890b32b5e4e876dbca61ddd214b", "osv": "9.1", "ua": "Mozilla/5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13B143", "model": "iPhone 6"}, "bcat": ["IAB25", "IAB26", "IAB7-39", "IAB8-18", "IAB8-5", "IAB9-9", "IAB3-7"], "id": "f1619eef-6533-4d6d-bef1-f12e54555bc7"}
    RTB Request 				API=${RTB_MOPUB_API}          data=${data}		response_code=200  	adgroup_expected=${mp4_ag}      submit_client_impression_event=NO
	[Tags]		

Mopub - Mime type application/x-shockwave-flash 
	[Documentation]		QA_REGRESSION_TESTS>05_RTB_Mopub>
	Set Test Variable	${mime_type} 		"application/x-shockwave-flash", "video/quicktime", "video/x-m4v"
	Set Test Variable	${country}			CAN
	Set Test Variable 	${data}			{"app": {"publisher": {"id": "505c3fa7cade4495a3aaf0b0e50e3880", "name": "Science Mobile, LLC"}, "ver": "4.2.0", "name": "Slingshot", "bundle": "1022441952", "cat": ["IAB24", "social_networking"], "id": "${app_id}", "storeurl": "https://itunes.apple.com/us/app/slingshot/id1022441952?mt=8"}, "imp": [{"bidfloor": 0.001, "tagid": "46137b023c87430c9296cccc531d7f31", "displaymanagerver": "3.8.0", "displaymanager": "mopub", "ext": {"secure": 0}, "video": {"protocol": 2, "mimes": [${mime_type}], "h": 320, "linearity": 1, "battr": [3, 8, 9, 10, 14], "api": [3, 5], "w": 480, "minduration": 0, "maxduration": 120, "protocols": [2, 5, 3, 6]}, "instl": 1, "banner": {"h": 50, "battr": [3, 8, 9, 10, 14], "pos": 1, "ext": {"nativebrowserclick": 1}, "api": [3, 5], "w": 320, "btype": [4]}, "id": "1"}], "at": 2, "device": {"geo": {"city": "Buffalo", "region": "NY", "metro": "514", "zip": "14218", "country": "${country}"}, "language": "en", "os": "iOS", "make": "Apple", "connectiontype": 2, "js": 1, "dpidsha1": "587607f6465cab44f448484f9be5283a4512f4cd", "dnt": 0, "ifa": "E236DAD5-07F7-415B-AC48-FA6C8698A051", "carrier": "310-120", "devicetype": 1, "ip": "76.180.53.26", "dpidmd5": "7f1d6890b32b5e4e876dbca61ddd214b", "osv": "9.1", "ua": "Mozilla/5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13B143", "model": "iPhone 6"}, "bcat": ["IAB25", "IAB26", "IAB7-39", "IAB8-18", "IAB8-5", "IAB9-9", "IAB3-7"], "id": "f1619eef-6533-4d6d-bef1-f12e54555bc7"}
    RTB Request 				API=${RTB_MOPUB_API}          data=${data}		response_code=200  	adgroup_expected=${mraid1_2_ag}      submit_client_impression_event=NO
	[Tags]		

Mopub - Mime type vpaid2 application/javascript
	[Documentation]		QA_REGRESSION_TESTS>05_RTB_Mopub>
	Set Test Variable	${mime_type} 		"application/javascript", "video/quicktime", "video/x-m4v"
	Set Test Variable	${country}			GUAM
	Set Test Variable 	${data}			{"app": {"publisher": {"id": "505c3fa7cade4495a3aaf0b0e50e3880", "name": "Science Mobile, LLC"}, "ver": "4.2.0", "name": "Slingshot", "bundle": "1022441952", "cat": ["IAB24", "social_networking"], "id": "${app_id}", "storeurl": "https://itunes.apple.com/us/app/slingshot/id1022441952?mt=8"}, "imp": [{"bidfloor": 0.001, "tagid": "46137b023c87430c9296cccc531d7f31", "displaymanagerver": "3.8.0", "displaymanager": "mopub", "ext": {"secure": 0}, "video": {"protocol": 2, "mimes": [${mime_type}], "h": 320, "linearity": 1, "battr": [3, 8, 9, 10, 14], "api": [3, 5], "w": 480, "minduration": 0, "maxduration": 120, "protocols": [2, 5, 3, 6]}, "instl": 1, "banner": {"h": 50, "battr": [3, 8, 9, 10, 14], "pos": 1, "ext": {"nativebrowserclick": 1}, "api": [3, 5], "w": 320, "btype": [4]}, "id": "1"}], "at": 2, "device": {"geo": {"city": "Buffalo", "region": "NY", "metro": "514", "zip": "14218", "country": "${country}"}, "language": "en", "os": "iOS", "make": "Apple", "connectiontype": 2, "js": 1, "dpidsha1": "587607f6465cab44f448484f9be5283a4512f4cd", "dnt": 0, "ifa": "E236DAD5-07F7-415B-AC48-FA6C8698A051", "carrier": "310-120", "devicetype": 1, "ip": "76.180.53.26", "dpidmd5": "7f1d6890b32b5e4e876dbca61ddd214b", "osv": "9.1", "ua": "Mozilla/5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13B143", "model": "iPhone 6"}, "bcat": ["IAB25", "IAB26", "IAB7-39", "IAB8-18", "IAB8-5", "IAB9-9", "IAB3-7"], "id": "f1619eef-6533-4d6d-bef1-f12e54555bc7"}
    RTB Request 				API=${RTB_MOPUB_API}          data=${data}		response_code=200  	adgroup_expected=${mraid2_ag}      submit_client_impression_event=NO
	[Tags]		

Mopub - Mime type video/mp4 and application/javascript (serve USA)
	[Documentation]		QA_REGRESSION_TESTS>05_RTB_Mopub> 
	Set Test Variable	${mime_type} 		"application/javascript", "video/3gpp2", "video/mp4", "video/quicktime", "video/x-m4v"
	Set Test Variable	${country}			USA
	Set Test Variable 	${data}			{"app": {"publisher": {"id": "505c3fa7cade4495a3aaf0b0e50e3880", "name": "Science Mobile, LLC"}, "ver": "4.2.0", "name": "Slingshot", "bundle": "1022441952", "cat": ["IAB24", "social_networking"], "id": "${app_id}", "storeurl": "https://itunes.apple.com/us/app/slingshot/id1022441952?mt=8"}, "imp": [{"bidfloor": 0.001, "tagid": "46137b023c87430c9296cccc531d7f31", "displaymanagerver": "3.8.0", "displaymanager": "mopub", "ext": {"secure": 0}, "video": {"protocol": 2, "mimes": [${mime_type}], "h": 320, "linearity": 1, "battr": [3, 8, 9, 10, 14], "api": [3, 5], "w": 480, "minduration": 0, "maxduration": 120, "protocols": [2, 5, 3, 6]}, "instl": 1, "banner": {"h": 50, "battr": [3, 8, 9, 10, 14], "pos": 1, "ext": {"nativebrowserclick": 1}, "api": [3, 5], "w": 320, "btype": [4]}, "id": "1"}], "at": 2, "device": {"geo": {"city": "Buffalo", "region": "NY", "metro": "514", "zip": "14218", "country": "${country}"}, "language": "en", "os": "iOS", "make": "Apple", "connectiontype": 2, "js": 1, "dpidsha1": "587607f6465cab44f448484f9be5283a4512f4cd", "dnt": 0, "ifa": "E236DAD5-07F7-415B-AC48-FA6C8698A051", "carrier": "310-120", "devicetype": 1, "ip": "76.180.53.26", "dpidmd5": "7f1d6890b32b5e4e876dbca61ddd214b", "osv": "9.1", "ua": "Mozilla/5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13B143", "model": "iPhone 6"}, "bcat": ["IAB25", "IAB26", "IAB7-39", "IAB8-18", "IAB8-5", "IAB9-9", "IAB3-7"], "id": "f1619eef-6533-4d6d-bef1-f12e54555bc7"}
    RTB Request 				API=${RTB_MOPUB_API}          data=${data}		response_code=200  	adgroup_expected=${mp4_ag}      submit_client_impression_event=NO
	[Tags]		

Mopub - Mime type video/mp4 and application/javascript (serve guam)
	[Documentation]		QA_REGRESSION_TESTS>05_RTB_Mopub> 
	Set Test Variable	${mime_type} 		"application/javascript", "video/3gpp2", "video/mp4", "video/quicktime", "video/x-m4v"
	Set Test Variable	${country}			GUAM
	Set Test Variable 	${data}			{"app": {"publisher": {"id": "505c3fa7cade4495a3aaf0b0e50e3880", "name": "Science Mobile, LLC"}, "ver": "4.2.0", "name": "Slingshot", "bundle": "1022441952", "cat": ["IAB24", "social_networking"], "id": "${app_id}", "storeurl": "https://itunes.apple.com/us/app/slingshot/id1022441952?mt=8"}, "imp": [{"bidfloor": 0.001, "tagid": "46137b023c87430c9296cccc531d7f31", "displaymanagerver": "3.8.0", "displaymanager": "mopub", "ext": {"secure": 0}, "video": {"protocol": 2, "mimes": [${mime_type}], "h": 320, "linearity": 1, "battr": [3, 8, 9, 10, 14], "api": [3, 5], "w": 480, "minduration": 0, "maxduration": 120, "protocols": [2, 5, 3, 6]}, "instl": 1, "banner": {"h": 50, "battr": [3, 8, 9, 10, 14], "pos": 1, "ext": {"nativebrowserclick": 1}, "api": [3, 5], "w": 320, "btype": [4]}, "id": "1"}], "at": 2, "device": {"geo": {"city": "Buffalo", "region": "NY", "metro": "514", "zip": "14218", "country": "${country}"}, "language": "en", "os": "iOS", "make": "Apple", "connectiontype": 2, "js": 1, "dpidsha1": "587607f6465cab44f448484f9be5283a4512f4cd", "dnt": 0, "ifa": "E236DAD5-07F7-415B-AC48-FA6C8698A051", "carrier": "310-120", "devicetype": 1, "ip": "76.180.53.26", "dpidmd5": "7f1d6890b32b5e4e876dbca61ddd214b", "osv": "9.1", "ua": "Mozilla/5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13B143", "model": "iPhone 6"}, "bcat": ["IAB25", "IAB26", "IAB7-39", "IAB8-18", "IAB8-5", "IAB9-9", "IAB3-7"], "id": "f1619eef-6533-4d6d-bef1-f12e54555bc7"}
    RTB Request 				API=${RTB_MOPUB_API}          data=${data}		response_code=200  	adgroup_expected=${mraid2_ag}      submit_client_impression_event=NO
	[Tags]		
Mopub - Mime type video/mp4 and application/javascript application/x-shockwave-flash (serve can)
	[Documentation]		QA_REGRESSION_TESTS>05_RTB_Mopub> 
	Set Test Variable	${mime_type} 		"application/javascript", "application/x-shockwave-flash", "video/mp4", "video/quicktime", "video/x-m4v"
	Set Test Variable	${country}			CAN
	Set Test Variable 	${data}			{"app": {"publisher": {"id": "505c3fa7cade4495a3aaf0b0e50e3880", "name": "Science Mobile, LLC"}, "ver": "4.2.0", "name": "Slingshot", "bundle": "1022441952", "cat": ["IAB24", "social_networking"], "id": "${app_id}", "storeurl": "https://itunes.apple.com/us/app/slingshot/id1022441952?mt=8"}, "imp": [{"bidfloor": 0.001, "tagid": "46137b023c87430c9296cccc531d7f31", "displaymanagerver": "3.8.0", "displaymanager": "mopub", "ext": {"secure": 0}, "video": {"protocol": 2, "mimes": [${mime_type}], "h": 320, "linearity": 1, "battr": [3, 8, 9, 10, 14], "api": [3, 5], "w": 480, "minduration": 0, "maxduration": 120, "protocols": [2, 5, 3, 6]}, "instl": 1, "banner": {"h": 50, "battr": [3, 8, 9, 10, 14], "pos": 1, "ext": {"nativebrowserclick": 1}, "api": [3, 5], "w": 320, "btype": [4]}, "id": "1"}], "at": 2, "device": {"geo": {"city": "Buffalo", "region": "NY", "metro": "514", "zip": "14218", "country": "${country}"}, "language": "en", "os": "iOS", "make": "Apple", "connectiontype": 2, "js": 1, "dpidsha1": "587607f6465cab44f448484f9be5283a4512f4cd", "dnt": 0, "ifa": "E236DAD5-07F7-415B-AC48-FA6C8698A051", "carrier": "310-120", "devicetype": 1, "ip": "76.180.53.26", "dpidmd5": "7f1d6890b32b5e4e876dbca61ddd214b", "osv": "9.1", "ua": "Mozilla/5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13B143", "model": "iPhone 6"}, "bcat": ["IAB25", "IAB26", "IAB7-39", "IAB8-18", "IAB8-5", "IAB9-9", "IAB3-7"], "id": "f1619eef-6533-4d6d-bef1-f12e54555bc7"}
    RTB Request 				API=${RTB_MOPUB_API}          data=${data}		response_code=200  	adgroup_expected=${mraid1_2_ag}      submit_client_impression_event=NO
	[Tags]		